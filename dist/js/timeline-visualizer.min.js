!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).TimelineVisualizer=e()}}(function(){return function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}}()({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("tslib").__exportStar(e("./lib/timelineVisualizer"),n)},{"./lib/timelineVisualizer":2,tslib:16}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TimelineVisualizer=void 0;const r=e("lodash.isequal"),i=e("superfly-timeline"),s=e("events"),o=1,a=.25,l=100,c=1.001,u=10,f=60,d=1,h="#333333",v="#666666",p="#999999",y=1,b="rgba(255, 0, 0, 0.5)",m=5,_="black",g=1,w="Calibri",j=16,O="white",E="rgb(22, 102, 247, 0.75)",T="rgba(232, 240, 255, 0.85)",S=1,x=1,R=0,I=1;n.TimelineVisualizer=class extends s.EventEmitter{constructor(e,t={}){super(),this.stepSize=o,this._layerLabelWidthProportionOfCanvas=a,this._layerLabels={},this._timelineState={},this._hoveredObjectMap={},this._viewStartTime=0,this._mouseDown=!1,this._timelineZoom=l,this._playHeadPlaying=!1,this._playSpeed=d,this._playHeadTime=0,this._updateDrawLastTime=0,this._lastHoverAction=I,this._lastHoveredHash="",this._timelineResolveAuto=!1,this._timelineResolveStart=0,this._timelineResolveEnd=0,this._timelineResolveZoom=1,this._timelineResolveCount=100,this._timelineResolveCountAdjust=1,this._timelineResolveExpand=3,this.latestUpdateTime=0,this.reresolveTimeout=null,this._mergeIterator=0,this._canvasId=e,this.initCanvas(),this._drawPlayhead=!!t.drawPlayhead,this._layerLabelWidth=this._canvasWidth*this._layerLabelWidthProportionOfCanvas,this._viewDrawX=this._layerLabelWidth,this._viewDrawWidth=this._canvasWidth-this._layerLabelWidth,this.drawBackground(),this.drawPlayhead(),this.updateDraw()}initCanvas(){if(this._canvasContainer=document.getElementById(this._canvasId),!this._canvasContainer)throw new Error(`Canvas "${this._canvasId}" not found`);this._canvas=this._canvasContainer.getContext("2d"),this._canvasContainer.addEventListener("mousedown",e=>this.canvasMouseDown(e)),this._canvasContainer.addEventListener("mouseup",e=>this.canvasMouseUp(e)),this._canvasContainer.addEventListener("mousemove",e=>this.canvasMouseMove(e)),this._canvasContainer.addEventListener("wheel",e=>this.canvasScrollWheel(e)),this._canvasWidth=this._canvasContainer.width,this._canvasHeight=this._canvasContainer.height}updateTimeline(e,t){void 0===t&&(t={time:0,limitCount:10}),this.latestTimeline=e,this.latestOptions=t,t.limitTime?this._timelineResolveAuto=!1:this._timelineResolveAuto=!0;const n=Object.assign({},t);this._timelineResolveAuto&&this.updateTimelineResolveWindow(),void 0===this._resolvedStates&&(void 0!==n.time&&(this._viewStartTime=n.time),this._playHeadTime=this._viewStartTime),this._updateTimeline(!0)}_updateTimeline(e=!1){const t=Object.assign({},this.latestOptions);this._timelineResolveAuto&&(t.time=this._timelineResolveStart,t.limitTime=this._timelineResolveEnd,t.limitCount=Math.ceil(this._timelineResolveCount*this._timelineResolveCountAdjust)),this._drawPlayhead&&this._playHeadTime>t.time&&(t.time=this._playHeadTime);const n=Date.now(),r=i.Resolver.resolveTimeline(this.latestTimeline,t);let s=i.Resolver.resolveAllStates(r);void 0===this._resolvedStates?this._resolvedStates=s:this._drawPlayhead?s&&(this._resolvedStates=this.mergeTimelineObjects(this._resolvedStates,s,e)):this._resolvedStates=s,this.updateLayerLabels(),this.latestUpdateTime=Date.now()-n,this.redrawTimeline(),this.latestUpdateTime=Date.now()-n}setViewPort(e){let t=!1;if(void 0!==e.zoom&&(this._timelineZoom=e.zoom,t=!0),void 0!==e.timestamp&&e.timestamp>0&&(this._viewStartTime=e.timestamp,t=!0),void 0!==e.playViewPort&&(this._playViewPort=e.playViewPort),void 0!==e.playSpeed){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playSpeed was set, but drawPlayhead was not set in constructor");this._playSpeed=e.playSpeed}if(void 0!==e.playPlayhead){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playPlayhead was set, but drawPlayhead was not set in constructor");this._playHeadPlaying=e.playPlayhead}if(void 0!==e.playheadTime){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playheadTime was set, but drawPlayhead was not set in constructor");this._playHeadTime=Math.max(0,e.playheadTime),this._playHeadTime>0&&(this._updateDrawLastTime=this._playHeadTime),t=!0}!0===t&&this.redrawTimeline()}getHoveredObject(){return this._hoveredOver}calculateRowHeight(e){return Math.min(f,this._canvasHeight/Object.keys(e).length)}updateLayerLabels(){const e=this.getLayersToDraw();r(this._layerLabels,e.layers)||(this._layerLabels=e.layers,this._rowHeight=this.calculateRowHeight(this._layerLabels),this._timelineObjectHeight=this._rowHeight*x,this._numberOfLayers=Object.keys(this._layerLabels).length,this._rowsTotalHeight=this._rowHeight*this._numberOfLayers)}getLayers(){const e=Object.entries(this._layerLabels);return e.sort((e,t)=>e[1]-t[1]),e.map(e=>e[0])}drawLayerLabels(){let e=0;for(let t of this.getLayers())this._canvas.fillStyle=v,this._canvas.fillRect(0,e*this._rowHeight,this._layerLabelWidth,this._rowHeight),this._canvas.fillStyle=O,this._canvas.font=j.toString()+"px "+w,this._canvas.textBaseline="middle",this._canvas.fillText(t,0,e*this._rowHeight+this._rowHeight/2,this._layerLabelWidth),0!==this._layerLabels[t]&&(this._canvas.fillStyle=_,this._canvas.fillRect(this._layerLabelWidth,e*this._rowHeight,this._viewDrawWidth,g)),e++}drawBackground(){this._canvas.fillStyle=h,this._canvas.fillRect(0,0,this._canvasWidth,this._canvasHeight),this.drawBackgroundRuler()}drawBackgroundRuler(){const e=this.viewRange,t=this.viewEndTime,n=Math.pow(10,Math.floor(Math.log10(e/5))),r=10*n,i=Math.floor(e/n),s=n,o=Math.floor(this._viewStartTime/n)*n,a=Math.min(1,5/i);if(s){this._canvas.strokeStyle=p,this._canvas.lineWidth=y;for(let e=o;e<t;e+=s){this._canvas.beginPath();let t=this.timeToXCoord(e),n=e/r%1;n>.5&&(n-=1),n=Math.abs(n),this._canvas.globalAlpha=n<.01?1:a,t>=this._viewDrawX&&(this._canvas.moveTo(t,0),this._canvas.lineTo(t,this._canvasHeight)),this._canvas.stroke()}this._canvas.globalAlpha=1}}drawPlayhead(){this._drawPlayhead&&this.istimeInView(this._playHeadTime)&&(this._canvas.fillStyle=b,this._canvas.fillRect(this.timeToXCoord(this._playHeadTime),0,m,this._canvasHeight))}getLayersToDraw(){this._hoveredObjectMap={};const e=this._resolvedStates?Object.keys(this._resolvedStates.layers):[];e.sort((e,t)=>e.localeCompare(t));const t={};return e.forEach((e,n)=>{t[e]=n,this._hoveredObjectMap[e]=[]}),{layers:t,layersArray:e}}redrawTimeline(){this._canvas.clearRect(0,0,this._canvasWidth,this._canvasHeight),this.drawBackground(),this.drawLayerLabels(),this._timelineState=this.getTimelineDrawState(this._resolvedStates),this.drawTimelineState(this._timelineState),this.drawPlayhead(),this.checkAutomaticReresolve()}drawTimelineState(e){for(let t in e){const n=e[t];n.visible&&(this._canvas.fillStyle=E,this._canvas.fillRect(n.left,n.top,n.width,n.height),this._canvas.strokeStyle=T,this._canvas.lineWidth=S,this._canvas.strokeRect(n.left,n.top,n.width,n.height),this._canvas.fillStyle=O,this._canvas.font=j.toString()+"px "+w,this._canvas.textBaseline="top",this._canvas.fillText(n.title,n.left,n.top))}}getTimelineDrawState(e){let t={};if(e)for(let n in e.objects){let r=e.objects[n];for(let e=0;e<r.resolved.instances.length;e++){let i=r.resolved.instances[e],s="timelineObject:"+n+":"+i.id;t[s]=this.createStateForObject(r,i.start,i.end),!0===t[s].visible&&(this._hoveredObjectMap[r.layer+""]||(this._hoveredObjectMap[r.layer+""]=[]),this._hoveredObjectMap[r.layer+""].push({startX:t[s].left,endX:t[s].left+t[s].width,objectRefId:n,instanceId:i.id,type:"timelineObject",name:s}))}}return t}createStateForObject(e,t,n){let r={height:0,left:0,top:0,width:0,visible:!1,title:"N/A"};if(this.showOnTimeline(t,n)){let i=this.getObjectWidth(t,n),s=this.capXcoordToView(this.timeToXCoord(t)),o=this.getObjectOffsetFromTop(e.layer+"");r.height=this._timelineObjectHeight,r.left=s,r.top=o,r.width=i,r.visible=!0,r.title=e.id}return r}getObjectWidth(e,t){return t?(e<this._viewStartTime&&(e=this._viewStartTime),(t-e)*this.pixelsWidthPerUnitTime):this._canvasWidth}showOnTimeline(e,t){let n=e>=this.viewEndTime,r=(t||1/0)<=this._viewStartTime;return!n&&!r}getObjectOffsetFromTop(e){return this._layerLabels[e]*this._rowHeight}updateDraw(){const e=Date.now(),t=(this._updateDrawLastTime>0?e-this._updateDrawLastTime:1)/1e3;this._updateDrawLastTime=e;const n=this._playSpeed*t;let r=!1;this._playHeadPlaying&&this._drawPlayhead&&(this._playViewPort&&this.istimeInView(this._playHeadTime)&&(this._viewStartTime+=n),this._playHeadTime+=n,r=!0),r&&this.redrawTimeline(),window.requestAnimationFrame(()=>this.updateDraw())}canvasMouseDown(e){this._mouseDown=!0,this._mouseLastX=e.clientX,e.preventDefault(),e.stopPropagation()}canvasMouseUp(e){this._mouseDown=!1,this._lastScrollDirection=0,e.preventDefault(),e.stopPropagation()}canvasMouseMove(e){if(this._mouseDown){if(void 0===this._lastScrollDirection||0===this._lastScrollDirection){this._mouseLastX=e.clientX;let t=e.clientX-this._mouseLastX;this._lastScrollDirection=t<0?-1:1,this.canvasScrollByDeltaX(-t)}else{let t=this._mouseLastX-e.clientX;if(t<0&&1===this._lastScrollDirection)this._mouseLastX=e.clientX,this._lastScrollDirection=-1;else if(t>0&&-1===this._lastScrollDirection)this._mouseLastX=e.clientX,this._lastScrollDirection=1;else{let t=e.clientX-this._mouseLastX;this._mouseLastX=e.clientX,this.canvasScrollByDeltaX(-t)}}this.redrawTimeline()}else{let t=!1,n=this.getMousePos(this._canvasContainer,e);if(n.x>this._viewDrawX&&n.y<this._rowsTotalHeight){let e,r=Math.floor(n.y/this._rowsTotalHeight*this._numberOfLayers);Object.keys(this._layerLabels).forEach(t=>{this._layerLabels[t]===r&&(e=t)}),((e?this._hoveredObjectMap[e]:[])||[]).forEach(e=>{if(e.startX<=n.x&&e.endX>=n.x){t=!0;const r=e.type+e.objectRefId+e.instanceId;if(this._lastHoveredHash!==r&&"timelineObject"===e.type&&this._resolvedStates){let t=this._resolvedStates.objects[e.objectRefId],i=t.resolved.instances.find(t=>t.id===e.instanceId);if(i){let e={object:t,instance:i,pointer:{xPostion:n.x,yPosition:n.y}};this._hoveredOver=e,this.emit("timeline:hover",{detail:this._hoveredOver})}this._lastHoverAction=R,this._lastHoveredHash=r}}})}t||this._lastHoverAction!==R||(this.emit("timeline:hover",{detail:void 0}),this._lastHoverAction=I)}}canvasScrollWheel(e){let t=this.getMousePos(this._canvasContainer,e);if(t.x<=this._viewDrawX)return;let n=!1;if(!0===e.ctrlKey){if(e.deltaY){n=!0;const r=Math.pow(c,-e.deltaY);this.zoomUnderCursor(t.x,r)}}else 0!==e.deltaX?(n=!0,this.canvasScrollByDeltaX(e.deltaX*(u*this.stepSize))):0!==e.deltaY&&!0===e.altKey&&(n=!0,this.canvasScrollByDeltaX(e.deltaY*(u*this.stepSize)));e.preventDefault(),e.stopPropagation(),n&&this.redrawTimeline()}canvasScrollByDeltaX(e){let t=this._viewStartTime+e/this.pixelsWidthPerUnitTime;t<0&&(t=0),t!==this._viewStartTime&&(this._viewStartTime=t)}zoomUnderCursor(e,t){let n=this.xCoordToTime(e),r=this.timeToRatio(n);this._timelineZoom=this._timelineZoom*t;let i=n-(r=Math.max(0,Math.min(1,r)))*this.viewRange;i<0&&(i=0),this._viewStartTime=i}getMousePos(e,t){const n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}trimTimeline(e,t){let n={};return Object.keys(e.objects).forEach(r=>{const i=e.objects[r],s=[];if(i.resolved.instances.forEach(e=>{let n=!1,r=Object.assign({},e);t.start&&(e.end||1/0)>t.start&&(n=!0,r.start<t.start&&(r.start=t.start)),t.end&&e.start<t.end&&(n=!0,(r.end||1/0)>t.end&&(r.end=t.end)),t.start||t.end||(n=!0),n&&r.start<(r.end||1/0)&&s.push(r)}),!n[r]){let e={content:i.content,enable:i.enable,id:i.id,layer:i.layer,resolved:{instances:[],levelDeep:i.resolved.levelDeep,resolved:i.resolved.resolved,resolving:i.resolved.resolving,directReferences:i.resolved.directReferences}};n[r]=e}n[r].resolved.instances=s}),{classes:e.classes,layers:e.layers,objects:n,options:e.options,statistics:e.statistics,state:e.state,nextEvents:e.nextEvents}}mergeTimelineObjects(e,t,n){const i={};n?(e=this.trimTimeline(e,{end:this._playHeadTime}),t=this.trimTimeline(t,{start:this._playHeadTime}),this._mergeIterator++,Object.keys(e.objects).forEach(n=>{const s=e.objects[n];if(s.__pastObj)return void(i[n]=s);const o=t.objects[n];if(o){if(r(Object.assign({},s,{resolved:null}),Object.assign({},o,{resolved:null}))){const e={};return s.resolved.instances.forEach(t=>{e[t.end+""]=t}),o.resolved.instances.forEach(t=>{e[t.start+""]?e[t.start+""].end=t.end:e[t.start+""]=t}),o.resolved.instances=[],Object.keys(e).forEach(t=>{const n=e[t];o.resolved.instances.push(n)}),void(i[n]=o)}i[n]=o}s.__pastObj=!0,i[this._mergeIterator+"__"+n]=s}),Object.keys(t.objects).forEach(n=>{const r=t.objects[n];e.objects[n]||(i[n]=r)})):(Object.keys(e.objects).forEach(t=>{const n=e.objects[t];i[t]=n}),Object.keys(t.objects).forEach(e=>{const n=t.objects[e],r=i[e];if(r){const e={};r.resolved.instances.forEach(t=>{e[t.start+"_"+t.end]=!0}),n.resolved.instances.forEach(t=>{e[t.start+"_"+t.end]||r.resolved.instances.push(t)})}else i[e]=n}));const s={};return Object.keys(i).forEach(e=>{const t=i[e].layer+"";s[t]||(s[t]=[]),s[t].push(e)}),Object.assign(Object.assign({},t),{objects:i,layers:s})}updateTimelineResolveWindow(){const{start:e,end:t}=this.getExpandedStartEndTime(1);if(this._timelineResolveStart=e,this._timelineResolveEnd=t,this._timelineResolveZoom=this._timelineZoom,this.latestUpdateTime){let e=50/this.latestUpdateTime;this._timelineResolveCountAdjust=Math.max(.1,Math.min(10,(1+this._timelineResolveCountAdjust*e)/2))}}getExpandedStartEndTime(e=1){let t=this._viewStartTime,n=this.viewEndTime,r=(n-t)*(this._timelineResolveExpand-1)*e;return t-=.33*r,n+=.66*r,{start:t=Math.max(0,t),end:n=Math.max(0,n),zoomDiff:Math.max(this._timelineResolveZoom,this._timelineZoom)/Math.min(this._timelineResolveZoom,this._timelineZoom)}}checkAutomaticReresolve(){const{start:e,end:t,zoomDiff:n}=this.getExpandedStartEndTime(.2);this._timelineResolveAuto&&(e<this._timelineResolveStart||t>this._timelineResolveEnd||n>3)&&(this.reresolveTimeout||(this.reresolveTimeout=setTimeout(()=>{this.reresolveTimeout=null,this.updateTimelineResolveWindow(),this._updateTimeline()},Math.max(100,5*this.latestUpdateTime))))}timeToXCoord(e){return this._viewDrawX+(e-this._viewStartTime)*this.pixelsWidthPerUnitTime}xCoordToTime(e){return this._viewStartTime+(e-this._viewDrawX)/this.pixelsWidthPerUnitTime}timeToRatio(e){return(e-this._viewStartTime)/this.viewRange}istimeInView(e){const t=this.timeToRatio(e);return t>=0&&t<1}capXcoordToView(e){return Math.max(this._viewDrawX,Math.min(this._viewDrawX+this._viewDrawWidth,e))}get pixelsWidthPerUnitTime(){return this._timelineZoom/100}get viewRange(){return this._viewDrawWidth/this.pixelsWidthPerUnitTime}get viewEndTime(){return this._viewStartTime+this.viewRange}}},{events:3,"lodash.isequal":4,"superfly-timeline":7}],3:[function(e,t,n){var r=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},s=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function o(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0;var a,l=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),a=0===c.x}catch(e){a=!1}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,i){var s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=r(null),e._eventsCount=0),a){if("function"==typeof a?a=o[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),!a.warned&&(s=u(e))&&s>0&&a.length>s){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else a=o[t]=n,++e._eventsCount;return e}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=s.call(d,r);return i.listener=n,r.wrapFn=i,i}function v(e,t,n){var r=e._events;if(!r)return[];var i=r[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length):[]}function p(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}a?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');l=e}}):o.defaultMaxListeners=l,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){var t,n,r,i,s,o,a="error"===e;if(o=this._events)a=a&&null==o.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(n=o[e]))return!1;var c="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=y(e,r),s=0;s<r;++s)i[s].call(n)}(n,c,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=y(e,i),o=0;o<i;++o)s[o].call(n,r)}(n,c,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=y(e,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=y(e,o),l=0;l<o;++l)a[l].call(n,r,i,s)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=y(e,i),o=0;o<i;++o)s[o].apply(n,r)}(n,c,this,i)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,s,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=r(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,s=o;break}if(s<0)return this;0===s?n.shift():function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,s),1===n.length&&(i[e]=n[0]),i.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.removeAllListeners=function(e){var t,n,s;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=r(null):delete n[e]),this;if(0===arguments.length){var o,a=i(n);for(s=0;s<a.length;++s)"removeListener"!==(o=a[s])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},o.prototype.listeners=function(e){return v(this,e,!0)},o.prototype.rawListeners=function(e){return v(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],4:[function(e,t,n){(function(e){(function(){var r=200,i="__lodash_hash_undefined__",s=1,o=2,a=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",d="[object Date]",h="[object Error]",v="[object Function]",p="[object GeneratorFunction]",y="[object Map]",b="[object Number]",m="[object Null]",_="[object Object]",g="[object Proxy]",w="[object RegExp]",j="[object Set]",O="[object String]",E="[object Symbol]",T="[object Undefined]",S="[object ArrayBuffer]",x="[object DataView]",R=/^\[object .+?Constructor\]$/,I=/^(?:0|[1-9]\d*)$/,P={};P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P[l]=P[c]=P[S]=P[f]=P[x]=P[d]=P[h]=P[v]=P[y]=P[b]=P[_]=P[w]=P[j]=P[O]=P["[object WeakMap]"]=!1;var A="object"==typeof e&&e&&e.Object===Object&&e,M="object"==typeof self&&self&&self.Object===Object&&self,C=A||M||Function("return this")(),D="object"==typeof n&&n&&!n.nodeType&&n,L=D&&"object"==typeof t&&t&&!t.nodeType&&t,k=L&&L.exports===D,$=k&&A.process,H=function(){try{return $&&$.binding&&$.binding("util")}catch(e){}}(),N=H&&H.isTypedArray;function F(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function K(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function W(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var z,X,B,U=Array.prototype,V=Function.prototype,G=Object.prototype,q=C["__core-js_shared__"],Z=V.toString,Y=G.hasOwnProperty,J=(z=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",Q=G.toString,ee=RegExp("^"+Z.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=k?C.Buffer:void 0,ne=C.Symbol,re=C.Uint8Array,ie=G.propertyIsEnumerable,se=U.splice,oe=ne?ne.toStringTag:void 0,ae=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ce=(X=Object.keys,B=Object,function(e){return X(B(e))}),ue=He(C,"DataView"),fe=He(C,"Map"),de=He(C,"Promise"),he=He(C,"Set"),ve=He(C,"WeakMap"),pe=He(Object,"create"),ye=We(ue),be=We(fe),me=We(de),_e=We(he),ge=We(ve),we=ne?ne.prototype:void 0,je=we?we.valueOf:void 0;function Oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Se(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Te;++t<n;)this.add(e[t])}function xe(e){var t=this.__data__=new Ee(e);this.size=t.size}function Re(e,t){var n=Be(e),r=!n&&Xe(e),i=!n&&!r&&Ue(e),s=!n&&!r&&!i&&Ye(e),o=n||r||i||s,a=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=a.length;for(var c in e)!t&&!Y.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ke(c,l))||a.push(c);return a}function Ie(e,t){for(var n=e.length;n--;)if(ze(e[n][0],t))return n;return-1}function Pe(e){return null==e?void 0===e?T:m:oe&&oe in Object(e)?function(e){var t=Y.call(e,oe),n=e[oe];try{e[oe]=void 0;var r=!0}catch(e){}var i=Q.call(e);r&&(t?e[oe]=n:delete e[oe]);return i}(e):function(e){return Q.call(e)}(e)}function Ae(e){return Ze(e)&&Pe(e)==l}function Me(e,t,n,r,i){return e===t||(null==e||null==t||!Ze(e)&&!Ze(t)?e!=e&&t!=t:function(e,t,n,r,i,a){var u=Be(e),v=Be(t),p=u?c:Fe(e),m=v?c:Fe(t),g=(p=p==l?_:p)==_,T=(m=m==l?_:m)==_,R=p==m;if(R&&Ue(e)){if(!Ue(t))return!1;u=!0,g=!1}if(R&&!g)return a||(a=new xe),u||Ye(e)?Le(e,t,n,r,i,a):function(e,t,n,r,i,a,l){switch(n){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!a(new re(e),new re(t)));case f:case d:case b:return ze(+e,+t);case h:return e.name==t.name&&e.message==t.message;case w:case O:return e==t+"";case y:var c=K;case j:var u=r&s;if(c||(c=W),e.size!=t.size&&!u)return!1;var v=l.get(e);if(v)return v==t;r|=o,l.set(e,t);var p=Le(c(e),c(t),r,i,a,l);return l.delete(e),p;case E:if(je)return je.call(e)==je.call(t)}return!1}(e,t,p,n,r,i,a);if(!(n&s)){var I=g&&Y.call(e,"__wrapped__"),P=T&&Y.call(t,"__wrapped__");if(I||P){var A=I?e.value():e,M=P?t.value():t;return a||(a=new xe),i(A,M,n,r,a)}}if(!R)return!1;return a||(a=new xe),function(e,t,n,r,i,o){var a=n&s,l=ke(e),c=l.length,u=ke(t).length;if(c!=u&&!a)return!1;for(var f=c;f--;){var d=l[f];if(!(a?d in t:Y.call(t,d)))return!1}var h=o.get(e);if(h&&o.get(t))return h==t;var v=!0;o.set(e,t),o.set(t,e);for(var p=a;++f<c;){d=l[f];var y=e[d],b=t[d];if(r)var m=a?r(b,y,d,t,e,o):r(y,b,d,e,t,o);if(!(void 0===m?y===b||i(y,b,n,r,o):m)){v=!1;break}p||(p="constructor"==d)}if(v&&!p){var _=e.constructor,g=t.constructor;_!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g)&&(v=!1)}return o.delete(e),o.delete(t),v}(e,t,n,r,i,a)}(e,t,n,r,Me,i))}function Ce(e){return!(!qe(e)||(t=e,J&&J in t))&&(Ve(e)?ee:R).test(We(e));var t}function De(e){if(n=(t=e)&&t.constructor,r="function"==typeof n&&n.prototype||G,t!==r)return ce(e);var t,n,r,i=[];for(var s in Object(e))Y.call(e,s)&&"constructor"!=s&&i.push(s);return i}function Le(e,t,n,r,i,a){var l=n&s,c=e.length,u=t.length;if(c!=u&&!(l&&u>c))return!1;var f=a.get(e);if(f&&a.get(t))return f==t;var d=-1,h=!0,v=n&o?new Se:void 0;for(a.set(e,t),a.set(t,e);++d<c;){var p=e[d],y=t[d];if(r)var b=l?r(y,p,d,t,e,a):r(p,y,d,e,t,a);if(void 0!==b){if(b)continue;h=!1;break}if(v){if(!F(t,function(e,t){if(s=t,!v.has(s)&&(p===e||i(p,e,n,r,a)))return v.push(t);var s})){h=!1;break}}else if(p!==y&&!i(p,y,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function ke(e){return function(e,t,n){var r=t(e);return Be(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Je,Ne)}function $e(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function He(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ce(n)?n:void 0}Oe.prototype.clear=function(){this.__data__=pe?pe(null):{},this.size=0},Oe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Oe.prototype.get=function(e){var t=this.__data__;if(pe){var n=t[e];return n===i?void 0:n}return Y.call(t,e)?t[e]:void 0},Oe.prototype.has=function(e){var t=this.__data__;return pe?void 0!==t[e]:Y.call(t,e)},Oe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=pe&&void 0===t?i:t,this},Ee.prototype.clear=function(){this.__data__=[],this.size=0},Ee.prototype.delete=function(e){var t=this.__data__,n=Ie(t,e);return!(n<0||(n==t.length-1?t.pop():se.call(t,n,1),--this.size,0))},Ee.prototype.get=function(e){var t=this.__data__,n=Ie(t,e);return n<0?void 0:t[n][1]},Ee.prototype.has=function(e){return Ie(this.__data__,e)>-1},Ee.prototype.set=function(e,t){var n=this.__data__,r=Ie(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Te.prototype.clear=function(){this.size=0,this.__data__={hash:new Oe,map:new(fe||Ee),string:new Oe}},Te.prototype.delete=function(e){var t=$e(this,e).delete(e);return this.size-=t?1:0,t},Te.prototype.get=function(e){return $e(this,e).get(e)},Te.prototype.has=function(e){return $e(this,e).has(e)},Te.prototype.set=function(e,t){var n=$e(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,i),this},Se.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.clear=function(){this.__data__=new Ee,this.size=0},xe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xe.prototype.get=function(e){return this.__data__.get(e)},xe.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ee){var i=n.__data__;if(!fe||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Te(i)}return n.set(e,t),this.size=n.size,this};var Ne=ae?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}(ae(e),function(t){return ie.call(e,t)}))}:function(){return[]},Fe=Pe;function Ke(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||I.test(e))&&e>-1&&e%1==0&&e<t}function We(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(ue&&Fe(new ue(new ArrayBuffer(1)))!=x||fe&&Fe(new fe)!=y||de&&"[object Promise]"!=Fe(de.resolve())||he&&Fe(new he)!=j||ve&&"[object WeakMap]"!=Fe(new ve))&&(Fe=function(e){var t=Pe(e),n=t==_?e.constructor:void 0,r=n?We(n):"";if(r)switch(r){case ye:return x;case be:return y;case me:return"[object Promise]";case _e:return j;case ge:return"[object WeakMap]"}return t});var Xe=Ae(function(){return arguments}())?Ae:function(e){return Ze(e)&&Y.call(e,"callee")&&!ie.call(e,"callee")},Be=Array.isArray;var Ue=le||function(){return!1};function Ve(e){if(!qe(e))return!1;var t=Pe(e);return t==v||t==p||t==u||t==g}function Ge(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function qe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ze(e){return null!=e&&"object"==typeof e}var Ye=N?function(e){return function(t){return e(t)}}(N):function(e){return Ze(e)&&Ge(e.length)&&!!P[Pe(e)]};function Je(e){return null!=(t=e)&&Ge(t.length)&&!Ve(t)?Re(e):De(e);var t}t.exports=function(e,t){return Me(e,t)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventType=void 0,function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.KEYFRAME=2]="KEYFRAME"}(n.EventType||(n.EventType={}))},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.validateKeyframe=n.validateObject=n.validateTimeline=n.Resolver=void 0;const r=e("tslib");(0,r.__exportStar)(e("./api/enums"),n),(0,r.__exportStar)(e("./api/api"),n);var i=e("./resolver/resolver");Object.defineProperty(n,"Resolver",{enumerable:!0,get:function(){return i.Resolver}});var s=e("./resolver/validate");Object.defineProperty(n,"validateTimeline",{enumerable:!0,get:function(){return s.validateTimeline}}),Object.defineProperty(n,"validateObject",{enumerable:!0,get:function(){return s.validateObject}}),Object.defineProperty(n,"validateKeyframe",{enumerable:!0,get:function(){return s.validateKeyframe}})},{"./api/api":5,"./api/enums":6,"./resolver/resolver":12,"./resolver/validate":14,tslib:15}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cleanCacheResult=n.cacheResult=n.applyParentInstances=n.setInstanceStartTime=n.setInstanceEndTime=n.resetId=n.getId=n.joinCaps=n.addCapsToResuming=n.joinReferences=n.isReference=n.capInstances=n.applyRepeatingInstances=n.operateOnArrays=n.invertInstances=n.convertEventsToInstances=n.cleanInstances=n.sortEvents=n.isNumeric=n.isConstant=n.extendMandadory=void 0;const r=e("underscore");function i(e){return null!==e&&(!!r.isNumber(e)||!!r.isString(e)&&!(!e.match(/^[-+]?[0-9.]+$/)||r.isNaN(parseFloat(e))))}function s(e){return e.sort((e,t)=>{if(e.time>t.time)return 1;if(e.time<t.time)return-1;const n=e.data&&(e.data.id||e.data.instance&&e.data.instance.id),r=t.data&&(t.data.id||t.data.instance&&t.data.instance.id);if(n&&r&&n===r){if(e.value&&!t.value)return-1;if(!e.value&&t.value)return 1}return e.value&&!t.value?1:!e.value&&t.value?-1:0})}function o(e,t,n=!1){if(0===e.length)return[];if(1===e.length)return e;const r=[];for(let t=0;t<e.length;t++){const n=e[t];r.push({time:n.start,value:!0,data:{instance:n},references:n.references}),null!==n.end&&r.push({time:n.end,value:!1,data:{instance:n},references:n.references})}return a(r,t,n)}function a(e,t,n=!1){s(e);const r={};let i=null,o=!1;const a={};let c=!1,u=null;const f=[];for(let s=0;s<e.length;s++){const d=e[s],h=d.data.id||d.data.instance.id,v=f[f.length-1];if(d.value?(r[h]=d,delete a[h]):(delete r[h],a[h]=d),Object.keys(r).length){if(!t&&!n&&v&&c)v.start=d.time;else{const e=l(d,v,i,h,r,t,n);i=e.activeInstanceId,e.returnInstance&&f.push(e.returnInstance)}o=!0,c=!1}else{if(v&&o)v.end=d.time;else if(Object.keys(a).length){const e=l(d,v,u,h,a,t,n);u=e.activeInstanceId,e.returnInstance&&f.push({...e.returnInstance,start:e.returnInstance.end||0,end:e.returnInstance.start}),c=!0}o=!1}}return f}function l(e,t,n,i,s,o,a=!1){let l=null;if(!o&&e.value&&t&&null===t.end&&null!==n&&n!==i)t.end=e.time,l={id:p(),start:e.time,end:null,references:e.references,originalEnd:e.data.instance.originalEnd,originalStart:e.data.instance.originalStart},n=i;else if(o||e.value||!t||n!==i)o&&!a&&t&&t.end===e.time?(t.end=null,t.references=f(t.references,e.references),d(t,e.data.instance.caps)):t&&null===t.end?(t.references=f(t.references,e.references),d(t,e.data.instance.caps)):(l={id:i,start:e.time,end:null,references:e.references,caps:e.data.instance.caps,originalEnd:e.data.instance.originalEnd,originalStart:e.data.instance.originalStart},n=i);else{const o=r.reduce(s,(e,t,n)=>null===e||e.event.time<t.time?{event:t,id:n}:e,null);o&&(t.end=e.time,l={id:i+"_"+p(),start:e.time,end:null,references:o.event.references,originalEnd:e.data.instance.originalEnd,originalStart:e.data.instance.originalStart},n=o.id)}return t&&t.caps&&!t.caps.length&&delete t.caps,l&&t&&t.start===t.end&&t.end===l.start&&(t.id=l.id,t.start=l.start,t.end=l.end,t.references=l.references,t.caps=l.caps,t.originalStart=l.originalStart,t.originalEnd=l.originalEnd,l=null),{activeInstanceId:n,returnInstance:l}}function c(e,t,n){if(null===e||null===t)return null;if(u(e)&&u(t))return n(e,t);const i=[],s=Math.min(r.isArray(e)?e.length:1/0,r.isArray(t)?t.length:1/0);for(let o=0;o<s;o++){const s=r.isArray(e)?e[o]:{id:"",start:e.value,end:e.value,references:e.references},a=r.isArray(t)?t[o]:{id:"",start:t.value,end:t.value,references:t.references},l=s.isFirst?{value:s.start,references:s.references}:a.isFirst?{value:a.start,references:a.references}:n({value:s.start,references:f(s.id,s.references)},{value:a.start,references:f(a.id,a.references)}),c=s.isFirst?null!==s.end?{value:s.end,references:s.references}:null:a.isFirst?null!==a.end?{value:a.end,references:a.references}:null:n(null!==s.end?{value:s.end,references:f(s.id,s.references)}:null,null!==a.end?{value:a.end,references:f(a.id,a.references)}:null);null!==l&&i.push({id:p(),start:l.value,end:null===c?null:c.value,references:f(l.references,null!==c?c.references:[]),caps:h(s.caps,a.caps)})}return o(i,!1)}function u(e){const t=e;return"object"==typeof t&&!r.isArray(t)&&void 0!==t.value&&r.isArray(t.references)&&null!==t}function f(...e){const t={},n=[];for(let r=0;r<e.length;r++){const i=e[r];if(i)if("string"==typeof i)t[i]||n.push(i),t[i]=!0;else for(let e=0;e<i.length;e++){const r=i[e];r&&(t[r]||n.push(r),t[r]=!0)}}return n.sort((e,t)=>e>t?1:e<t?-1:0)}function d(e,...t){const n=[],r=h(...t);for(let t=0;t<r.length;t++){const i=r[t];null!==i.end&&null!==e.end&&i.end>e.end&&n.push({id:i.id,start:0,end:i.end})}e.caps=h(e.caps,n)}function h(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];if(r)for(let e=0;e<r.length;e++){const n=r[e];t[n.id]=n}}return Object.values(t)}n.extendMandadory=function(e,t){return r.extend(e,t)},n.isConstant=function(e){return!!(i(e)||r.isString(e)&&(e.match(/^true$/)||e.match(/^false$/)))},n.isNumeric=i,n.sortEvents=s,n.cleanInstances=o,n.convertEventsToInstances=a,n.invertInstances=function(e){if(e.length){const t=[];0!==(e=o(e,!0,!0))[0].start&&t.push({id:p(),isFirst:!0,start:0,end:null,references:f(e[0].references,e[0].id)});for(let n=0;n<e.length;n++){const i=e[n],s=r.last(t);s&&(s.end=i.start),null!==i.end&&t.push({id:p(),start:i.end,end:null,references:f(i.references,i.id),caps:i.caps})}return t}return[{id:p(),isFirst:!0,start:0,end:null,references:[]}]},n.operateOnArrays=c,n.applyRepeatingInstances=function(e,t,n){if(null===t||!t.value)return e;const i=t.value;u(e)&&(e=[{id:"",start:e.value,end:null,references:e.references}]);const s=[];for(let o=0;o<e.length;o++){const a=e[o];let l=Math.max(n.time-(n.time-a.start)%i,a.start),c=null===a.end?null:a.end+(l-a.start);const u=(a.caps?r.find(a.caps,e=>-1!==a.references.indexOf(e.id)):null)||null,d=n.limitCount||2;for(let e=0;e<d&&!(n.limitTime&&l>=n.limitTime);e++){const e=u?Math.max(u.start,l):l,n=u&&null!==u.end&&null!==c?Math.min(u.end,c):c;(null!=n?n:1/0)>e&&s.push({id:p(),start:e,end:n,references:f(a.id,a.references,t.references)}),l+=i,null!==c&&(c+=i)}}return o(s,!1)},n.capInstances=function(e,t){var n,i,s,a,l,c;if(u(t)||null===t)return e;let d=[];for(let o=0;o<e.length;o++){const u=e[o],h=new Set;for(let e=0;e<t.length;e++){const o=t[e];if(u.start<=(null!==(n=o.end)&&void 0!==n?n:1/0)&&(null!==(i=u.end)&&void 0!==i?i:1/0)>=o.start){const e=r.clone(u);e.start<o.start&&b(e,o.start),(null!==(s=e.end)&&void 0!==s?s:1/0)>(null!==(a=o.end)&&void 0!==a?a:1/0)&&y(e,o.end),e.start>=o.start&&(null!==(l=e.end)&&void 0!==l?l:1/0)<=(null!==(c=o.end)&&void 0!==c?c:1/0)&&(e.start===e.end&&h.has(e.start)||(e.references=f(e.references,o.references),d.push(e),h.add(e.start),e.end&&h.add(e.end)))}}}d.sort((e,t)=>e.start-t.start);const h={};for(let e=0;e<d.length;e++){const t=d[e];void 0!==h[t.id]?t.id=t.id+ ++h[t.id]:h[t.id]=0}return d=o(d,!0,!0)},n.isReference=u,n.joinReferences=f,n.addCapsToResuming=d,n.joinCaps=h;let v=0;function p(){return"@"+(v++).toString(36)}function y(e,t){e.originalEnd=void 0!==e.originalEnd?e.originalEnd:e.end,e.end=t}function b(e,t){e.originalStart=void 0!==e.originalStart?e.originalStart:e.start,e.start=t}function m(e,t){return null===e||null===t?null:{value:e.value+t.value,references:f(e.references,t.references)}}n.getId=p,n.resetId=function(){v=0},n.setInstanceEndTime=y,n.setInstanceStartTime=b,n.applyParentInstances=function(e,t){return c(e,t,m)};const _={};let g=null;function w(){g&&(clearTimeout(g),g=null),r.each(_,(e,t)=>{e.ttl<Date.now()&&delete _[t]})}n.cacheResult=function(e,t,n=1e3){Math.random()<.01&&(g&&clearTimeout(g),g=setTimeout(()=>{w()},100));const r=_[e];if(!r||r.ttl<Date.now()){const r=t();return _[e]={ttl:Date.now()+n,value:r},r}return r.value},n.cleanCacheResult=w},{underscore:17}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getObjectReferences=n.hashTimelineObject=n.initializeCache=void 0,n.initializeCache=function(e,t){const n=e;return n.objHashes||(n.objHashes={}),n.resolvedTimeline||(n.resolvedTimeline=t),n},n.hashTimelineObject=function(e){return[JSON.stringify(e.enable),e.disabled+"",e.priority+"",e.resolved.parentId||"",e.resolved.isKeyframe+"",e.classes?e.classes.join("."):"",e.layer+"",e.seamless+""].join(",")},n.getObjectReferences=function(e){return e.resolved.directReferences}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.addObjectToResolvedTimeline=void 0,n.addObjectToResolvedTimeline=function(e,t){if(e.objects[t.id]=t,t.classes)for(let n=0;n<t.classes.length;n++){const r=t.classes[n];r&&(e.classes[r]||(e.classes[r]=[]),e.classes[r].push(t.id))}t.layer&&(e.layers[t.layer]||(e.layers[t.layer]=[]),e.layers[t.layer].push(t.id))}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.validateExpression=n.wrapInnerExpressions=n.simplifyExpression=n.interpretExpression=n.OPERATORS=void 0;const r=e("underscore"),i=e("../lib");n.OPERATORS=["&","|","+","-","*","/","%","!"];const s=r.map(n.OPERATORS,e=>"\\"+e).join("");function o(e){if((0,i.isNumeric)(e))return parseFloat(e);if(r.isString(e)){const t=e;return(0,i.cacheResult)(t,()=>{const e=t.replace(new RegExp("(["+s+"\\(\\)])","g")," $1 "),i=r.compact(e.split(" "));if(0===i.length)return null;for(let e=i.length-2;e>=1;e--)"-"!==i[e]&&"+"!==i[e]||!a(n.OPERATORS,i[e-1])||(i[e]=i[e]+i[e+1],i.splice(e+1,1));const o=l(i);if(o.rest.length)throw new Error("interpretExpression: syntax error: parentheses don't add up in \""+e+'".');if(o.inner.length%2!=1)throw new Error("interpretExpression: operands & operators don't add up: \""+o.inner.join(" ")+'".');const u=function e(t,n){if(!n||!n.length)throw new Error("words2Expression: syntax error: unbalanced expression");for(;1===n.length&&r.isArray(n[0]);)n=n[0];if(1===n.length)return n[0];let i=-1;for(let e=0;e<t.length;e++){const r=t[e];-1===i&&(i=n.lastIndexOf(r))}if(-1!==i){const r=n.slice(0,i),s=n.slice(i+1),o={l:e(t,r),o:n[i],r:e(t,s)};return o}throw new Error('words2Expression: syntax error: operator not found: "'+n.join(" ")+'"')}(n.OPERATORS,o.inner);return c(n.OPERATORS,u),u},1e5)}return e}function a(e,t){return-1!==e.indexOf(t)}function l(e){for(let t=0;t<e.length;t++)if("("===e[t]){const n=l(e.slice(t+1));e[t]=n.inner,e.splice(t+1,99999,...n.rest)}else{if(")"===e[t])return{inner:e.slice(0,t),rest:e.slice(t+1)};if("!"===e[t]){const n=l(e.slice(t+1));e[t]=["","!"].concat(n.inner),e.splice(t+1,99999,...n.rest)}}return{inner:e,rest:[]}}function c(e,t,n){if(n||(n="ROOT"),r.isObject(t)&&!r.isArray(t)){const i=t;if(!r.has(i,"l"))throw new Error(`validateExpression: ${n}.l missing in ${JSON.stringify(i)}`);if(!r.has(i,"o"))throw new Error(`validateExpression: ${n}.o missing in ${JSON.stringify(i)}`);if(!r.has(i,"r"))throw new Error(`validateExpression: ${n}.r missing in ${JSON.stringify(i)}`);if(!r.isString(i.o))throw new Error(`validateExpression: ${n}.o not a string`);if(!a(e,i.o))throw new Error(n+'.o not valid: "'+i.o+'"');return c(e,i.l,n+".l")&&c(e,i.r,n+".r")}if(!r.isNull(t)&&!r.isString(t)&&!r.isNumber(t))throw new Error(`validateExpression: ${n} is of invalid type`);return!0}n.interpretExpression=o,n.simplifyExpression=function e(t){const n=r.isString(t)?o(t):t;if(!n)return n;if(function(e){return"object"==typeof e&&r.has(e,"l")&&r.has(e,"o")&&r.has(e,"r")}(n)){const t=e(n.l),s=n.o,o=e(n.r);return(0,i.isConstant)(t)&&(0,i.isConstant)(o)&&r.isNumber(t)&&r.isNumber(o)?"+"===s?t+o:"-"===s?t-o:"*"===s?t*o:"/"===s?t/o:"%"===s?t%o:{l:t,o:s,r:o}:{l:t,o:s,r:o}}return n},n.wrapInnerExpressions=l,n.validateExpression=c},{"../lib":8,underscore:17}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.lookupExpression=n.resolveTimelineObj=n.Resolver=void 0;const r=e("underscore"),i=e("../lib"),s=e("./validate"),o=e("./expression"),a=e("./state"),l=e("./common"),c=e("./cache");function u(e,t){if(t.resolved.resolved)return;if(t.resolved.resolving)throw new Error(`Circular dependency when trying to resolve "${t.id}"`);t.resolved.resolving=!0,e.statistics.resolvingCount++;let n=[],s=[];const a=r.isArray(t.enable)?t.enable:[t.enable];for(let l=0;l<a.length;l++){const c=a[l];let u=[];const f=h(e,t,void 0!==c.repeating?(0,o.interpretExpression)(c.repeating):null,"duration"),d=f.instances;if(s=s.concat(f.allReferences),r.isArray(d))throw new Error("lookupExpression should never return an array for .duration lookup");let v=void 0!==c.while?c.while:void 0!==c.start?c.start:"";c.while+""=="1"?v="true":c.while+""=="0"&&(v="false");const p=(0,o.simplifyExpression)(v);let y=null,b=!1,m=!1;if(t.resolved.parentId){b=!0;const n=h(e,t,(0,o.interpretExpression)(`#${t.resolved.parentId}`),"start");y=n.instances,s=s.concat(n.allReferences),(0,i.isConstant)(p)&&(m=!0)}const _=h(e,t,p,"start");let g=_.instances;if(s=s.concat(_.allReferences),m&&(g=(0,i.applyParentInstances)(y,g)),c.while)r.isArray(g)?u=g:null!==g&&(u=[{id:(0,i.getId)(),start:g.value,end:null,references:g.references}]);else{const n=[];let a=0,l=0;if(r.isArray(g))for(let e=0;e<g.length;e++){const r=g[e];n.push({time:r.start,value:!0,data:{instance:r,id:t.id+"_"+a++},references:r.references})}else null!==g&&n.push({time:g.value,value:!0,data:{instance:{id:(0,i.getId)(),start:g.value,end:null,references:g.references},id:t.id+"_"+a++},references:g.references});if(void 0!==c.end){const a=(0,o.interpretExpression)(c.end);let u=!1;t.resolved.parentId&&(0,i.isConstant)(a)&&(u=!0);const f=a?h(e,t,a,"end"):null;let d=f?f.instances:null;if(f&&(s=s.concat(f.allReferences)),u&&(d=(0,i.applyParentInstances)(y,d)),r.isArray(d))for(let e=0;e<d.length;e++){const r=d[e];n.push({time:r.start,value:!1,data:{instance:r,id:t.id+"_"+l++},references:r.references})}else null!==d&&n.push({time:d.value,value:!1,data:{instance:{id:(0,i.getId)(),start:d.value,end:null,references:d.references},id:t.id+"_"+l++},references:d.references})}else if(void 0!==c.duration){const a=h(e,t,(0,o.interpretExpression)(c.duration),"duration");let l=a.instances;if(s=s.concat(a.allReferences),r.isArray(l)&&1===l.length&&(l={value:l[0].start,references:l[0].references}),r.isArray(l)&&!l.length&&(l=null),r.isArray(l))throw new Error("lookupExpression should never return an array for .duration lookup");if(null!==l){null!==d&&l.value>d.value&&(l.value=d.value);const e=l;for(let t=0;t<n.length;t++){const r=n[t];if(r.value){const t=r.time+e.value,s=(0,i.joinReferences)(r.references,e.references);n.push({time:t,value:!1,data:{id:r.data.id,instance:{id:r.data.instance.id,start:t,end:null,references:s}},references:s})}}}}u=(0,i.convertEventsToInstances)(n,!1)}if(b){const e=[];for(let t=0;t<u.length;t++){const n=u[t];if(y){const t=r.find(y,e=>-1!==n.references.indexOf(e.id));if(t){const r=(0,i.capInstances)([n],[t])[0];r&&(r.caps||(r.caps=[]),r.caps.push({id:t.id,start:t.start,end:t.end}),e.push(r))}else for(let t=0;t<y.length;t++){const r=y[t],s=(0,i.capInstances)([n],[r])[0];s&&(r&&(s.caps||(s.caps=[]),s.caps.push({id:r.id,start:r.start,end:r.end})),e.push(s))}}}u=e}u=(0,i.applyRepeatingInstances)(u,d,e.options),n=n.concat(u)}const l={};for(const e of n)l[e.id]&&(e.id=`${e.id}_${(0,i.getId)()}`),l[e.id]=!0;t.seamless&&n.length>1&&(n=(0,i.cleanInstances)(n,!0,!1)),t.resolved.resolved=!0,t.resolved.resolving=!1,t.resolved.instances=n,t.resolved.directReferences=s,f(e,t)}function f(e,t){t.resolved.instances.length?(e.statistics.resolvedInstanceCount+=t.resolved.instances.length,e.statistics.resolvedCount+=1,t.isGroup&&(e.statistics.resolvedGroupCount+=1),t.resolved.isKeyframe?e.statistics.resolvedKeyframeCount+=1:e.statistics.resolvedObjectCount+=1):e.statistics.unresolvedCount+=1}function d(e,t,n,r){if(e[t])return;if(e[t]=!0,"#"===t[0]){const e=t.slice(1);r[e]&&delete r[e]}const i=n[t];if(i)for(let t=0;t<i.length;t++){d(e,i[t],n,r)}}function h(e,t,n,s){if(null===n)return{instances:null,allReferences:[]};if(r.isString(n)&&(0,i.isNumeric)(n))return{instances:{value:parseFloat(n),references:[]},allReferences:[]};if(r.isNumber(n))return{instances:{value:n,references:[]},allReferences:[]};if(r.isString(n)){if(n=n.trim(),(0,i.isConstant)(n)){if(n.match(/^true$/i))return{instances:{value:0,references:[]},allReferences:[]};if(n.match(/^false$/i))return{instances:[],allReferences:[]}}let o=!1,a=!1,l=[],c=s,f="",d=[];const h=[];let v=!1;const p=n.match(/^\W*#([^.]+)(.*)/);if(p){const e=p[1];f=p[2],v=!0,d=[e],h.push("#"+e)}else{const t=n.match(/^\W*\.([^.]+)(.*)/);if(t){const n=t[1];f=t[2],v=!0,d=e.classes[n]||[],h.push("."+n)}else{const t=n.match(/^\W*\$([^.]+)(.*)/);if(t){const n=t[1];f=t[2],v=!0,d=e.layers[n]||[],h.push("$"+n)}}}for(let n=0;n<d.length;n++){const r=d[n];if(r!==t.id){const t=e.objects[r];t&&l.push(t)}else t.resolved.resolving&&(t.resolved.isSelfReferencing=!0)}if(!v)return{instances:null,allReferences:[]};if(t.resolved.isSelfReferencing&&(l=r.filter(l,e=>!e.resolved.isSelfReferencing)),l.length){if(f.match(/start/)&&(c="start"),f.match(/end/)&&(c="end"),f.match(/duration/)&&(c="duration"),"duration"===c){const n=[];for(let s=0;s<l.length;s++){const o=l[s];if(u(e,o),o.resolved.resolved)if(t.resolved.isSelfReferencing&&o.resolved.isSelfReferencing);else{const e=r.first(o.resolved.instances);if(e){const t=null!==e.end?e.end-e.start:null;null!==t&&n.push({value:t,references:(0,i.joinReferences)(o.id,e.references)})}}}let s=null;for(let e=0;e<n.length;e++){const t=n[e];(null===s||t.value<s.value)&&(s=t)}return{instances:s,allReferences:h}}{let n=[];if("start"===c);else{if("end"!==c)throw Error(`Unknown ref: "${c}"`);o=!o,a=!0}for(let r=0;r<l.length;r++){const i=l[r];u(e,i),i.resolved.resolved&&(t.resolved.isSelfReferencing&&i.resolved.isSelfReferencing||(n=n.concat(i.resolved.instances)))}if(n.length){if(n=o?(0,i.invertInstances)(n):(0,i.cleanInstances)(n,!0,!0),a){const e=r.first(n);e&&0===e.start&&n.splice(0,1)}return{instances:n,allReferences:h}}return{instances:[],allReferences:h}}}return{instances:[],allReferences:h}}if(n){const o=h(e,t,n.l,s),a=h(e,t,n.r,s),l={l:o.instances,o:n.o,r:a.instances},c=o.allReferences.concat(a.allReferences);if("!"===l.o)return l.r&&r.isArray(l.r)?{instances:(0,i.invertInstances)(l.r),allReferences:c}:{instances:l.r,allReferences:c};if(r.isNull(l.l)||r.isNull(l.r))return{instances:null,allReferences:c};if("&"===l.o||"|"===l.o){let e=[];const t=(t,n)=>{for(let r=0;r<t.length;r++){const i=t[r];i.start!==i.end&&(e.push({left:n,time:i.start,value:!0,references:[],data:!0,instance:i}),null!==i.end&&e.push({left:n,time:i.end,value:!1,references:[],data:!1,instance:i}))}};r.isArray(l.l)&&t(l.l,!0),r.isArray(l.r)&&t(l.r,!1),e=(0,i.sortEvents)(e);const n="&"===l.o?(e,t)=>!(!e||!t):"|"===l.o?(e,t)=>!(!e&&!t):()=>!1;let s=!!(0,i.isReference)(l.l)&&!!l.l.value,o=!!(0,i.isReference)(l.r)&&!!l.r.value,a=null,u=null,f=n(s,o);const d=[],h=(e,t,n,s)=>{if(t)d.push({id:(0,i.getId)(),start:e,end:null,references:n,caps:s});else{const t=r.last(d);t&&(t.end=e)}};h(0,f,(0,i.joinReferences)((0,i.isReference)(l.l)?l.l.references:[],(0,i.isReference)(l.r)?l.r.references:[]),[]);for(let t=0;t<e.length;t++){const r=e[t],l=e[t+1];if(r.left?(s=r.value,a=r.instance):(o=r.value,u=r.instance),!l||l.time!==r.time){const e=n(s,o),t=(a&&a.caps||[]).concat(u&&u.caps||[]);e!==f&&(h(r.time,e,(0,i.joinReferences)(a?a.references:[],u?u.references:[]),t),f=e)}}return{instances:d,allReferences:c}}{const e="+"===l.o?(e,t)=>({value:e.value+t.value,references:(0,i.joinReferences)(e.references,t.references)}):"-"===l.o?(e,t)=>({value:e.value-t.value,references:(0,i.joinReferences)(e.references,t.references)}):"*"===l.o?(e,t)=>({value:e.value*t.value,references:(0,i.joinReferences)(e.references,t.references)}):"/"===l.o?(e,t)=>({value:e.value/t.value,references:(0,i.joinReferences)(e.references,t.references)}):"%"===l.o?(e,t)=>({value:e.value%t.value,references:(0,i.joinReferences)(e.references,t.references)}):()=>null,t=(t,n)=>null===t||null===n?null:e(t,n);return{instances:(0,i.operateOnArrays)(l.l,l.r,t),allReferences:c}}}return{instances:null,allReferences:[]}}n.Resolver=class{static resolveTimeline(e,t){if(!r.isArray(e))throw new Error("resolveTimeline: parameter timeline missing");if(!t)throw new Error("resolveTimeline: parameter options missing");(0,s.validateTimeline)(e,!1),(0,i.resetId)();const n={options:{...t},objects:{},classes:{},layers:{},statistics:{unresolvedCount:0,resolvedCount:0,resolvedInstanceCount:0,resolvedObjectCount:0,resolvedGroupCount:0,resolvedKeyframeCount:0,resolvingCount:0}},o=(e,t,s,a)=>{if(n.objects[e.id])throw Error(`All timelineObjects must be unique! (duplicate: "${e.id}")`);const c=(0,i.extendMandadory)(r.clone(e),{resolved:{resolved:!1,resolving:!1,instances:[],levelDeep:t,isSelfReferencing:!1,directReferences:[]}});if(s&&(c.resolved.parentId=s,c.resolved.directReferences.push(s)),a&&(c.resolved.isKeyframe=!0),(0,l.addObjectToResolvedTimeline)(n,c),e.isGroup&&e.children)for(let n=0;n<e.children.length;n++){const r=e.children[n];o(r,t+1,e.id)}if(e.keyframes)for(let n=0;n<e.keyframes.length;n++){const s=e.keyframes[n],a=(0,i.extendMandadory)(r.clone(s),{layer:""});o(a,t+1,e.id,!0)}};for(let t=0;t<e.length;t++){const n=e[t];o(n,0)}if(t.cache){const e=(0,c.initializeCache)(t.cache,n),i={},s={},o=e=>{const t=["#"+e.id];if(e.classes)for(const n of e.classes)t.push("."+n);return e.layer&&t.push("$"+e.layer),t},a=e=>{const t=o(e);for(const e of t)s[e]=!0};for(const t of Object.values(n.objects)){const n=e.objHashes[t.id],r=(0,c.hashTimelineObject)(t);if(i[t.id]=!0,n&&n===r){const n=e.resolvedTimeline.objects[t.id];e.resolvedTimeline.objects[t.id]={...t,resolved:n.resolved}}else{e.objHashes[t.id]=r,a(t);const n=e.resolvedTimeline.objects[t.id];n&&a(n)}}if(e.hasOldData){for(const t in e.resolvedTimeline.objects)if(!i[t]){const n=e.resolvedTimeline.objects[t];delete e.objHashes[t],a(n)}const t={};for(const e of Object.values(n.objects))t[e.id]=e;const l={};for(const t of Object.values(n.objects)){const n=e.resolvedTimeline.objects[t.id];let i=o(t);n&&(i=r.uniq(i.concat(o(n))));for(let e=0;e<i.length;e++){const n=i[e],r="#"+t.id;n!==r&&(l[r]||(l[r]=[]),l[r].push(n))}if(s["#"+t.id]);else if(n){const e=(0,c.getObjectReferences)(n);for(let n=0;n<e.length;n++){const r=e[n];l[r]||(l[r]=[]),l[r].push("#"+t.id)}}}const u={};for(const e of Object.keys(s))d(u,e,l,t);for(const r of Object.values(t)){if(!e.resolvedTimeline.objects[r.id])throw new Error(`Something went wrong: "${r.id}" does not exist in cache.resolvedTimeline.objects`);n.objects[r.id]=e.resolvedTimeline.objects[r.id]}}for(const e of Object.values(n.objects))u(n,e);e.resolvedTimeline=n,e.hasOldData=!0,n.statistics.unresolvedCount=0,n.statistics.resolvedCount=0,n.statistics.resolvedInstanceCount=0,n.statistics.resolvedObjectCount=0,n.statistics.resolvedGroupCount=0,n.statistics.resolvedKeyframeCount=0;for(const e of Object.values(n.objects))f(n,e);return n}for(const e of Object.values(n.objects))u(n,e);return n}static resolveAllStates(e,t){return(0,a.resolveStates)(e,t)}static getState(e,t,n){return(0,a.getState)(e,t,n)}},n.resolveTimelineObj=u,n.lookupExpression=h},{"../lib":8,"./cache":9,"./common":10,"./expression":11,"./state":13,"./validate":14,underscore:17}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.applyKeyframeContent=n.resolveStates=n.getState=void 0;const r=e("underscore"),i=e("./common"),s=e("../api/enums"),o=e("../lib");function a(e,t){var n,a,l,f,d,h,v,p;const y={options:e.options,statistics:e.statistics,objects:{},classes:{},layers:{},state:{},nextEvents:[]};if(t&&0===e.statistics.resolvingCount&&t.resolvedStates)return t.resolvedStates;const b=r.values(e.objects);b.sort((e,t)=>(e.resolved.levelDeep||0)>(t.resolved.levelDeep||0)?1:(e.resolved.levelDeep||0)<(t.resolved.levelDeep||0)?-1:e.id>t.id?1:e.id<t.id?-1:0);const m={},_=(e,t,n,r,i)=>{m[e+""]||(m[e+""]=[]),m[e+""].push({obj:r,instance:i,checkId:t,order:n})};for(const t of b)if(!t.disabled&&t.resolved.resolved)if(t.resolved.isKeyframe){if(t.resolved.isKeyframe&&t.resolved.parentId){const e=t;for(const t of e.resolved.instances)_(t.start,"start",1,e,t),null!==t.end&&_(t.end,"end",0,e,t)}}else{const r=c(e,t);if(t.layer)for(const e of t.resolved.instances){const i=[];i.push({time:e.start,enable:!0}),e.end&&i.push({time:e.end,enable:!1});for(let t=0;t<r.length;t++){const s=r[t];s&&s.time>(e.start||0)&&s.time<(null!==(n=e.end)&&void 0!==n?n:1/0)&&i.push(s)}for(let n=0;n<i.length;n++){const r=i[n];r.enable?_(r.time,"start",1,t,e):_(r.time,"end",0,t,e)}}}const g={},w={},j={},O={},E={},T={},S=[],x=Object.keys(m).map(e=>parseFloat(e)).sort((e,t)=>e-t);for(let t=0;t<x.length;t++){const n=x[t],c=m[n],u={};c.sort((e,t)=>{if(e.obj.resolved&&t.obj.resolved){if(e.obj.resolved.isKeyframe&&!t.obj.resolved.isKeyframe)return-1;if(!e.obj.resolved.isKeyframe&&t.obj.resolved.isKeyframe)return 1;if(e.order>t.order)return 1;if(e.order<t.order)return-1;if((e.obj.resolved.levelDeep||0)>(t.obj.resolved.levelDeep||0))return 1;if((e.obj.resolved.levelDeep||0)<(t.obj.resolved.levelDeep||0))return-1}return 0});for(let t=0;t<c.length;t++){const v=c[t],p=v.obj,b=v.instance;let m=(b.start||0)<=n&&(null!==(a=b.end)&&void 0!==a?a:1/0)>n;const S=p.layer+"",x=p.id+"_"+b.id+"_"+v.checkId;if(!u[x])if(u[x]=!0,p.resolved.isKeyframe){const e=p;if(y.objects[e.id]=e,(b.start||0)<=n&&(null!==(h=b.end)&&void 0!==h?h:1/0)>n){const t={...e,instance:b};O[e.id]=t}else delete O[e.id],delete E[e.id]}else{if(m&&p.resolved.parentId){const t=p.resolved.parentId?e.objects[p.resolved.parentId]:null;m=!(!t||t.layer&&!j[t.id])}T[p.layer]||(T[p.layer]=[]),m?T[p.layer].push({obj:p,instance:b}):T[S]=r.reject(T[S]||[],e=>e.obj.id===p.id),T[S].sort((e,t)=>(e.obj.priority||0)<(t.obj.priority||0)?1:(e.obj.priority||0)>(t.obj.priority||0)?-1:(e.instance.start||0)<(t.instance.start||0)?1:(e.instance.start||0)>(t.instance.start||0)?-1:e.obj.id>t.obj.id?1:e.obj.id<t.obj.id?-1:0);const t=T[S][0],a=w[S],c=t&&(!a||a.id!==t.obj.id||a.instance.id!==t.instance.id),u=!t&&a;(c||u)&&a&&((0,o.setInstanceEndTime)(a.instance,n),delete j[a.id],y.nextEvents.push({type:s.EventType.END,time:n,objId:a.id}),g[b.end+""]=s.EventType.END);let h=!1;if(c){let e;y.objects[t.obj.id]?e=y.objects[t.obj.id]:((e=r.clone(t.obj)).content=JSON.parse(JSON.stringify(e.content)),e.resolved={...e.resolved||{},instances:[]},(0,i.addObjectToResolvedTimeline)(y,e));const o={...t.instance,start:n,end:null,fromInstanceId:t.instance.id,originalEnd:void 0!==t.instance.originalEnd?t.instance.originalEnd:t.instance.end,originalStart:void 0!==t.instance.originalStart?t.instance.originalStart:t.instance.start};for(let t=0;t<e.resolved.instances.length;t++)e.resolved.instances[t].id===o.id&&(o.id=o.id+"_$"+e.resolved.instances.length);e.resolved.instances.push(o);const a={...e,instance:o};w[S]=a,j[a.id]=a,y.nextEvents.push({type:s.EventType.START,time:o.start,objId:p.id}),g[o.start+""]=s.EventType.START,h=!0}else u&&(delete w[S],h=!0);if(h){const t=[];p.isGroup&&t.push(p),(null===(l=w[S])||void 0===l?void 0:l.isGroup)&&t.push(w[S]);for(const r of t)if(null===(f=r.children)||void 0===f?void 0:f.length)for(const t of r.children){const r=e.objects[t.id];for(const e of r.resolved.instances)e.start<=n&&(null!==(d=e.end)&&void 0!==d?d:1/0)>n&&_(n,"child",99,r,e)}}}}const b=Object.keys(O);for(let e=0;e<b.length;e++){const t=b[e],n=O[t],r=n,i=n.instance;if(r.resolved.parentId){const e=j[r.resolved.parentId];if(e&&e.layer){const n=w[e.layer];if(n){if(!E[t]){E[t]=!0,S.push({type:s.EventType.KEYFRAME,time:i.start,objId:r.id});let e=Math.min(null!==(v=i.end)&&void 0!==v?v:1/0,null!==(p=n.instance.end)&&void 0!==p?p:1/0);e===1/0&&(e=null),null!==e&&S.push({type:s.EventType.KEYFRAME,time:e,objId:r.id})}continue}}}delete E[t]}}{const e=Object.values(y.objects).filter(e=>!!e.resolved.parentId).sort((e,t)=>{var n,r;return(null!==(n=e.resolved.levelDeep)&&void 0!==n?n:0)-(null!==(r=t.resolved.levelDeep)&&void 0!==r?r:0)});for(const t of e)if(t.resolved.parentId){const e=y.objects[t.resolved.parentId];e&&(t.resolved.instances=(0,o.cleanInstances)((0,o.capInstances)(t.resolved.instances,e.resolved.instances),!1,!1))}}{const e={};for(const t of Object.keys(y.objects)){const n=y.objects[t],r=`${n.layer}`;e[r]||(e[r]={});const i=e[r];if(!n.resolved.isKeyframe)for(const e of n.resolved.instances){const t=e.start+"";i[t]||(i[t]={startCount:0,endCount:0,objectInstance:null});const r={...n,instance:e};if(i[t].startCount++,i[t].objectInstance=r,null!==e.end){const t=e.end+"";i[t]||(i[t]={startCount:0,endCount:0,objectInstance:null}),i[t].endCount++}}}for(const t of Object.keys(e)){let n=0;const r=Object.keys(e[t]).map(e=>parseFloat(e)).sort((e,t)=>e-t);for(let i=0;i<r.length;i++){const s=r[i],o=e[t][`${s}`];if(n+=o.startCount,(n-=o.endCount)>1)throw new Error(`Too many start events at ${t} ${s}: ${n}`);if(n<0)throw new Error(`Too many end events at ${t} ${s}: ${n}`);if(y.state[t]||(y.state[t]={}),n){if(!o.objectInstance)throw new Error(`objectInstance not set, event though sum=${n} at ${t} ${s}`);y.state[t][s]=[o.objectInstance]}else y.state[t][s]=null}}}for(const e of Object.keys(y.objects)){{const t=y.objects[e];if(t.resolved.isKeyframe&&t.resolved.parentId){const e=y.objects[t.resolved.parentId];if(e){t.resolved.instances=(0,o.capInstances)(t.resolved.instances,e.resolved.instances);for(let n=0;n<t.resolved.instances.length;n++){const r=t.resolved.instances[n],i={...t,instance:r,isKeyframe:!0,keyframeEndTime:r.end};u(y.state,e.layer+"",r.start,i)}}}}{const t=y.objects[e];t.seamless&&t.resolved.instances.length>1&&(t.resolved.instances=(0,o.cleanInstances)(t.resolved.instances,!0,!1))}}for(let e=0;e<S.length;e++){const t=S[e];void 0===g[t.time+""]&&(y.nextEvents.push(t),g[t.time+""]=s.EventType.KEYFRAME)}return y.nextEvents.sort((e,t)=>e.time>t.time?1:e.time<t.time?-1:e.type>t.type?-1:e.type<t.type?1:e.objId<t.objId?-1:e.objId>t.objId?1:0),t&&(t.resolvedStates=y),y}function l(e,t){for(const[n,i]of Object.entries(t))r.isArray(i)?(r.isArray(e[n])||(e[n]=[]),l(e[n],i),e[n].splice(i.length,99999)):r.isObject(i)?(r.isObject(e[n])&&!r.isArray(e[n])||(e[n]={}),l(e[n],i)):e[n]=i}function c(e,t){let n=[];const r=t.resolved.parentId?e.objects[t.resolved.parentId]:null;if(r&&r.resolved.resolved){for(const e of r.resolved.instances)n.push({time:e.start,enable:!0}),e.end&&n.push({time:e.end,enable:!1});n=n.concat(c(e,r))}return n}function u(e,t,n,r){e[t]||(e[t]={});const i=e[t][n+""];i?i.push(r):e[t][n+""]=[r]}function f(e,t,n){var r;const i=e[t]||{},s=Object.keys(i).map(e=>parseFloat(e)).sort((e,t)=>e-t);let o=null,a=!1;for(let e=0;e<s.length;e++){const t=s[e];if(!(t<=n))break;{const e=i[t+""];if(e&&e.length){const t=[];for(let n=0;n<e.length;n++){const r=e[n];r&&r.isKeyframe?t.push(r):(o=r,a=!1)}for(let e=0;e<t.length;e++){const i=t[e];o&&i.resolved.parentId===o.id&&(null!==(r=i.keyframeEndTime)&&void 0!==r?r:1/0)>n&&(a||(a=!0,o={...o,content:JSON.parse(JSON.stringify(o.content))}),l(o.content,i.content))}}else o=null,a=!1}}return o}n.getState=function(e,t,n=0){const i=function(e){return!!(e&&"object"==typeof e&&e.objects&&e.state&&e.nextEvents)}(e)?e:a(e),s={time:t,layers:{},nextEvents:r.filter(i.nextEvents,e=>e.time>t)};n&&(s.nextEvents=s.nextEvents.slice(0,n));const o=Object.keys(i.layers);for(let e=0;e<o.length;e++){const n=o[e],r=f(i.state,n,t);r&&(s.layers[n]=r)}return s},n.resolveStates=a,n.applyKeyframeContent=l},{"../api/enums":6,"../lib":8,"./common":10,underscore:17}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.validateKeyframe=n.validateObject=n.validateTimeline=void 0;const r=e("underscore");function i(e,t,n){if(n||(n={}),!e)throw new Error("Object is undefined");if("object"!=typeof e)throw new Error("Object is not an object");if(!e.id)throw new Error('Object missing "id" attribute');if("string"!=typeof e.id)throw new Error(`Object "id" attribute is not a string: "${e.id}"`);if(n[e.id])throw new Error(`Object id "${e.id}" is not unique`);if(n[e.id]=!0,void 0===e.layer)throw new Error(`Object "${e.id}": "layer" attribute is undefined`);if(!e.content)throw new Error(`Object "${e.id}": "content" attribute must be set`);if(!e.enable)throw new Error(`Object "${e.id}": "enable" attribute must be set`);const o=r.isArray(e.enable)?e.enable:[e.enable];for(let n=0;n<o.length;n++){const r=o[n];if(void 0!==r.start){if(t&&void 0!==r.while)throw new Error(`Object "${e.id}": "enable.start" and "enable.while" cannot be combined`);if(t&&void 0!==r.end&&void 0!==r.duration)throw new Error(`Object "${e.id}": "enable.end" and "enable.duration" cannot be combined`)}else{if(void 0===r.while)throw new Error(`Object "${e.id}": "enable.start" or "enable.while" must be set`);if(t&&void 0!==r.end)throw new Error(`Object "${e.id}": "enable.while" and "enable.end" cannot be combined`);if(t&&void 0!==r.duration)throw new Error(`Object "${e.id}": "enable.while" and "enable.duration" cannot be combined`)}}if(e.keyframes)for(let r=0;r<e.keyframes.length;r++){const i=e.keyframes[r];try{s(i,t,n)}catch(t){throw new Error(`Object "${e.id}" keyframe[${r}]: ${t}`)}}if(e.classes)for(let t=0;t<e.classes.length;t++){const n=e.classes[t];if(n&&"string"!=typeof n)throw new Error(`Object "${e.id}": "classes[${t}]" is not a string`)}if(e.children&&!e.isGroup)throw new Error(`Object "${e.id}": attribute "children" is set but "isGroup" is not`);if(e.isGroup&&!e.children)throw new Error(`Object "${e.id}": attribute "isGroup" is set but "children" missing`);if(e.children)for(let r=0;r<e.children.length;r++){const s=e.children[r];try{i(s,t,n)}catch(t){throw new Error(`Object "${e.id}" child[${r}]: ${t}`)}}if(void 0!==e.priority&&!r.isNumber(e.priority))throw new Error(`Object "${e.id}": attribute "priority" is not a number`)}function s(e,t,n){if(n||(n={}),!e)throw new Error("Keyframe is undefined");if("object"!=typeof e)throw new Error("Keyframe is not an object");if(!e.id)throw new Error("Keyframe missing id attribute");if("string"!=typeof e.id)throw new Error(`Keyframe id attribute is not a string: "${e.id}"`);if(n[e.id])throw new Error(`Keyframe id "${e.id}" is not unique`);if(n[e.id]=!0,!e.content)throw new Error(`Keyframe "${e.id}": "content" attribute must be set`);if(!e.enable)throw new Error(`Keyframe "${e.id}": "enable" attribute must be set`);const i=r.isArray(e.enable)?e.enable:[e.enable];for(let n=0;n<i.length;n++){const r=i[n];if(void 0!==r.start){if(t&&void 0!==r.while)throw new Error(`Keyframe "${e.id}": "enable.start" and "enable.while" cannot be combined`);if(t&&void 0!==r.end&&void 0!==r.duration)throw new Error(`Keyframe "${e.id}": "enable.end" and "enable.duration" cannot be combined`)}else{if(void 0===r.while)throw new Error(`Keyframe "${e.id}": "enable.start" or "enable.while" must be set`);if(t&&void 0!==r.end)throw new Error(`Keyframe "${e.id}": "enable.while" and "enable.end" cannot be combined`);if(t&&void 0!==r.duration)throw new Error(`Keyframe "${e.id}": "enable.while" and "enable.duration" cannot be combined`)}}if(e.classes)for(let t=0;t<e.classes.length;t++){const n=e.classes[t];if(n&&!r.isString(n))throw new Error(`Keyframe "${e.id}": "classes[${t}]" is not a string`)}}n.validateTimeline=function(e,t){const n={};for(let r=0;r<e.length;r++)i(e[r],t,n)},n.validateObject=function(e,t){i(e,t)},n.validateKeyframe=function(e,t){s(e,t)}},{underscore:17}],15:[function(e,t,n){(function(e){(function(){var n,r,i,s,o,a,l,c,u,f,d,h,v,p,y,b,m,_,g,w,j,O,E,T,S;!function(n){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function i(e,t){return e!==r&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}"object"==typeof t&&"object"==typeof t.exports?n(i(r,i(t.exports))):n(i(r))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};n=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},s=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},o=function(e,t){return function(n,r){t(n,r,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})},c=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},u=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||S(t,e,n)},S=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},v=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r},p=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},y=function(e){return this instanceof y?(this.v=e,this):new y(e)},b=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},m=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}},_=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&S(t,e,n);return x(t,e),t},j=function(e){return e&&e.__esModule?e:{default:e}},O=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},E=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},T=function(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)},e("__extends",n),e("__assign",r),e("__rest",i),e("__decorate",s),e("__param",o),e("__metadata",a),e("__awaiter",l),e("__generator",c),e("__exportStar",u),e("__createBinding",S),e("__values",f),e("__read",d),e("__spread",h),e("__spreadArrays",v),e("__spreadArray",p),e("__await",y),e("__asyncGenerator",b),e("__asyncDelegator",m),e("__asyncValues",_),e("__makeTemplateObject",g),e("__importStar",w),e("__importDefault",j),e("__classPrivateFieldGet",O),e("__classPrivateFieldSet",E),e("__classPrivateFieldIn",T)})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(e,t,n){(function(e){(function(){var n,r,i,s,o,a,l,c,u,f,d,h,v,p,y,b,m,_,g,w,j,O,E;!function(n){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function i(e,t){return e!==r&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}"object"==typeof t&&"object"==typeof t.exports?n(i(r,i(t.exports))):n(i(r))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};n=function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},s=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},o=function(e,t){return function(n,r){t(n,r,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})},c=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},E=function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},u=function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},v=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r},p=function(e){return this instanceof p?(this.v=e,this):new p(e)},y=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{(n=i[e](t)).value instanceof p?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},b=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:p(e[r](t)),done:"return"===r}:i?i(t):t}:i}},m=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},_=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},w=function(e){return e&&e.__esModule?e:{default:e}},j=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},O=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},e("__extends",n),e("__assign",r),e("__rest",i),e("__decorate",s),e("__param",o),e("__metadata",a),e("__awaiter",l),e("__generator",c),e("__exportStar",u),e("__createBinding",E),e("__values",f),e("__read",d),e("__spread",h),e("__spreadArrays",v),e("__await",p),e("__asyncGenerator",y),e("__asyncDelegator",b),e("__asyncValues",m),e("__makeTemplateObject",_),e("__importStar",g),e("__importDefault",w),e("__classPrivateFieldGet",j),e("__classPrivateFieldSet",O)})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t,n){(function(e){(function(){!function(e,r){"object"==typeof n&&void 0!==t?t.exports=r():(e="undefined"!=typeof globalThis?globalThis:e||self,function(){var t=e._,n=e._=r();n.noConflict=function(){return e._=t,n}}())}(this,function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||Function("return this")()||{},n=Array.prototype,r=Object.prototype,i="undefined"!=typeof Symbol?Symbol.prototype:null,s=n.push,o=n.slice,a=r.toString,l=r.hasOwnProperty,c="undefined"!=typeof ArrayBuffer,u="undefined"!=typeof DataView,f=Array.isArray,d=Object.keys,h=Object.create,v=c&&ArrayBuffer.isView,p=isNaN,y=isFinite,b=!{toString:null}.propertyIsEnumerable("toString"),m=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function g(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var s=Array(t+1);for(i=0;i<t;i++)s[i]=arguments[i];return s[t]=r,e.apply(this,s)}}function w(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function j(e){return void 0===e}function O(e){return!0===e||!1===e||"[object Boolean]"===a.call(e)}function E(e){var t="[object "+e+"]";return function(e){return a.call(e)===t}}var T=E("String"),S=E("Number"),x=E("Date"),R=E("RegExp"),I=E("Error"),P=E("Symbol"),A=E("ArrayBuffer"),M=E("Function"),C=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof C&&(M=function(e){return"function"==typeof e||!1});var D=M,L=E("Object"),k=u&&L(new DataView(new ArrayBuffer(8))),$="undefined"!=typeof Map&&L(new Map),H=E("DataView");var N=k?function(e){return null!=e&&D(e.getInt8)&&A(e.buffer)}:H,F=f||E("Array");function K(e,t){return null!=e&&l.call(e,t)}var W=E("Arguments");!function(){W(arguments)||(W=function(e){return K(e,"callee")})}();var z=W;function X(e){return S(e)&&p(e)}function B(e){return function(){return e}}function U(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=_}}function V(e){return function(t){return null==t?void 0:t[e]}}var G=V("byteLength"),q=U(G),Z=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Y=c?function(e){return v?v(e)&&!N(e):q(e)&&Z.test(a.call(e))}:B(!1),J=V("length");function Q(e,t){t=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(e){return!0===t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var n=m.length,i=e.constructor,s=D(i)&&i.prototype||r,o="constructor";for(K(e,o)&&!t.contains(o)&&t.push(o);n--;)(o=m[n])in e&&e[o]!==s[o]&&!t.contains(o)&&t.push(o)}function ee(e){if(!w(e))return[];if(d)return d(e);var t=[];for(var n in e)K(e,n)&&t.push(n);return b&&Q(e,t),t}function te(e,t){var n=ee(t),r=n.length;if(null==e)return!r;for(var i=Object(e),s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function ne(e){return e instanceof ne?e:this instanceof ne?void(this._wrapped=e):new ne(e)}function re(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,G(e))}ne.VERSION="1.13.4",ne.prototype.value=function(){return this._wrapped},ne.prototype.valueOf=ne.prototype.toJSON=ne.prototype.value,ne.prototype.toString=function(){return String(this._wrapped)};var ie="[object DataView]";function se(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var s=typeof e;return("function"===s||"object"===s||"object"==typeof t)&&function e(t,n,r,s){t instanceof ne&&(t=t._wrapped);n instanceof ne&&(n=n._wrapped);var o=a.call(t);if(o!==a.call(n))return!1;if(k&&"[object Object]"==o&&N(t)){if(!N(n))return!1;o=ie}switch(o){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return i.valueOf.call(t)===i.valueOf.call(n);case"[object ArrayBuffer]":case ie:return e(re(t),re(n),r,s)}var l="[object Array]"===o;if(!l&&Y(t)){var c=G(t);if(c!==G(n))return!1;if(t.buffer===n.buffer&&t.byteOffset===n.byteOffset)return!0;l=!0}if(!l){if("object"!=typeof t||"object"!=typeof n)return!1;var u=t.constructor,f=n.constructor;if(u!==f&&!(D(u)&&u instanceof u&&D(f)&&f instanceof f)&&"constructor"in t&&"constructor"in n)return!1}r=r||[];s=s||[];var d=r.length;for(;d--;)if(r[d]===t)return s[d]===n;r.push(t);s.push(n);if(l){if((d=t.length)!==n.length)return!1;for(;d--;)if(!se(t[d],n[d],r,s))return!1}else{var h,v=ee(t);if(d=v.length,ee(n).length!==d)return!1;for(;d--;)if(h=v[d],!K(n,h)||!se(t[h],n[h],r,s))return!1}r.pop();s.pop();return!0}(e,t,n,r)}function oe(e){if(!w(e))return[];var t=[];for(var n in e)t.push(n);return b&&Q(e,t),t}function ae(e){var t=J(e);return function(n){if(null==n)return!1;var r=oe(n);if(J(r))return!1;for(var i=0;i<t;i++)if(!D(n[e[i]]))return!1;return e!==de||!D(n[le])}}var le="forEach",ce=["clear","delete"],ue=["get","has","set"],fe=ce.concat(le,ue),de=ce.concat(ue),he=["add"].concat(ce,le,"has"),ve=$?ae(fe):E("Map"),pe=$?ae(de):E("WeakMap"),ye=$?ae(he):E("Set"),be=E("WeakSet");function me(e){for(var t=ee(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function _e(e){for(var t={},n=ee(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function ge(e){var t=[];for(var n in e)D(e[n])&&t.push(n);return t.sort()}function we(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var s=arguments[i],o=e(s),a=o.length,l=0;l<a;l++){var c=o[l];t&&void 0!==n[c]||(n[c]=s[c])}return n}}var je=we(oe),Oe=we(ee),Ee=we(oe,!0);function Te(e){if(!w(e))return{};if(h)return h(e);var t=function(){};t.prototype=e;var n=new t;return t.prototype=null,n}function Se(e){return F(e)?e:[e]}function xe(e){return ne.toPath(e)}function Re(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0}function Ie(e,t,n){var r=Re(e,xe(t));return j(r)?n:r}function Pe(e){return e}function Ae(e){return e=Oe({},e),function(t){return te(t,e)}}function Me(e){return e=xe(e),function(t){return Re(t,e)}}function Ce(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}}function De(e,t,n){return null==e?Pe:D(e)?Ce(e,t,n):w(e)&&!F(e)?Ae(e):Me(e)}function Le(e,t){return De(e,t,1/0)}function ke(e,t,n){return ne.iteratee!==Le?ne.iteratee(e,t):De(e,t,n)}function $e(){}function He(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}ne.toPath=Se,ne.iteratee=Le;var Ne=Date.now||function(){return(new Date).getTime()};function Fe(e){var t=function(t){return e[t]},n="(?:"+ee(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}}var Ke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},We=Fe(Ke),ze=Fe(_e(Ke)),Xe=ne.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Be=/(.)^/,Ue={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ve=/\\|'|\r|\n|\u2028|\u2029/g;function Ge(e){return"\\"+Ue[e]}var qe=/^\s*(\w|\$)+\s*$/;var Ze=0;function Ye(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var s=Te(e.prototype),o=e.apply(s,i);return w(o)?o:s}var Je=g(function(e,t){var n=Je.placeholder,r=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===n?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return Ye(e,r,this,this,o)};return r});Je.placeholder=ne;var Qe=g(function(e,t,n){if(!D(e))throw new TypeError("Bind must be called on a function");var r=g(function(i){return Ye(e,r,t,this,n.concat(i))});return r}),et=U(J);function tt(e,t,n,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var i=r.length,s=0,o=J(e);s<o;s++){var a=e[s];if(et(a)&&(F(a)||z(a)))if(t>1)tt(a,t-1,n,r),i=r.length;else for(var l=0,c=a.length;l<c;)r[i++]=a[l++];else n||(r[i++]=a)}return r}var nt=g(function(e,t){var n=(t=tt(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=Qe(e[r],e)}return e});var rt=g(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),it=Je(rt,ne,1);function st(e){return function(){return!e.apply(this,arguments)}}function ot(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var at=Je(ot,2);function lt(e,t,n){t=ke(t,n);for(var r,i=ee(e),s=0,o=i.length;s<o;s++)if(t(e[r=i[s]],r,e))return r}function ct(e){return function(t,n,r){n=ke(n,r);for(var i=J(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(n(t[s],s,t))return s;return-1}}var ut=ct(1),ft=ct(-1);function dt(e,t,n,r){for(var i=(n=ke(n,r,1))(t),s=0,o=J(e);s<o;){var a=Math.floor((s+o)/2);n(e[a])<i?s=a+1:o=a}return s}function ht(e,t,n){return function(r,i,s){var a=0,l=J(r);if("number"==typeof s)e>0?a=s>=0?s:Math.max(s+l,a):l=s>=0?Math.min(s+1,l):s+l+1;else if(n&&s&&l)return r[s=n(r,i)]===i?s:-1;if(i!=i)return(s=t(o.call(r,a,l),X))>=0?s+a:-1;for(s=e>0?a:l-1;s>=0&&s<l;s+=e)if(r[s]===i)return s;return-1}}var vt=ht(1,ut,dt),pt=ht(-1,ft);function yt(e,t,n){var r=(et(e)?ut:lt)(e,t,n);if(void 0!==r&&-1!==r)return e[r]}function bt(e,t,n){var r,i;if(t=Ce(t,n),et(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var s=ee(e);for(r=0,i=s.length;r<i;r++)t(e[s[r]],s[r],e)}return e}function mt(e,t,n){t=ke(t,n);for(var r=!et(e)&&ee(e),i=(r||e).length,s=Array(i),o=0;o<i;o++){var a=r?r[o]:o;s[o]=t(e[a],a,e)}return s}function _t(e){return function(t,n,r,i){var s=arguments.length>=3;return function(t,n,r,i){var s=!et(t)&&ee(t),o=(s||t).length,a=e>0?0:o-1;for(i||(r=t[s?s[a]:a],a+=e);a>=0&&a<o;a+=e){var l=s?s[a]:a;r=n(r,t[l],l,t)}return r}(t,Ce(n,i,4),r,s)}}var gt=_t(1),wt=_t(-1);function jt(e,t,n){var r=[];return t=ke(t,n),bt(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}function Ot(e,t,n){t=ke(t,n);for(var r=!et(e)&&ee(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return!1}return!0}function Et(e,t,n){t=ke(t,n);for(var r=!et(e)&&ee(e),i=(r||e).length,s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return!0}return!1}function Tt(e,t,n,r){return et(e)||(e=me(e)),("number"!=typeof n||r)&&(n=0),vt(e,t,n)>=0}var St=g(function(e,t,n){var r,i;return D(t)?i=t:(t=xe(t),r=t.slice(0,-1),t=t[t.length-1]),mt(e,function(e){var s=i;if(!s){if(r&&r.length&&(e=Re(e,r)),null==e)return;s=e[t]}return null==s?s:s.apply(e,n)})});function xt(e,t){return mt(e,Me(t))}function Rt(e,t,n){var r,i,s=-1/0,o=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=et(e)?e:me(e)).length;a<l;a++)null!=(r=e[a])&&r>s&&(s=r);else t=ke(t,n),bt(e,function(e,n,r){((i=t(e,n,r))>o||i===-1/0&&s===-1/0)&&(s=e,o=i)});return s}var It=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Pt(e){return e?F(e)?o.call(e):T(e)?e.match(It):et(e)?mt(e,Pe):me(e):[]}function At(e,t,n){if(null==t||n)return et(e)||(e=me(e)),e[He(e.length-1)];var r=Pt(e),i=J(r);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=He(o,s),l=r[o];r[o]=r[a],r[a]=l}return r.slice(0,t)}function Mt(e,t){return function(n,r,i){var s=t?[[],[]]:{};return r=ke(r,i),bt(n,function(t,i){var o=r(t,i,n);e(s,t,o)}),s}}var Ct=Mt(function(e,t,n){K(e,n)?e[n].push(t):e[n]=[t]}),Dt=Mt(function(e,t,n){e[n]=t}),Lt=Mt(function(e,t,n){K(e,n)?e[n]++:e[n]=1}),kt=Mt(function(e,t,n){e[n?0:1].push(t)},!0);function $t(e,t,n){return t in n}var Ht=g(function(e,t){var n={},r=t[0];if(null==e)return n;D(r)?(t.length>1&&(r=Ce(r,t[1])),t=oe(e)):(r=$t,t=tt(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];r(a,o,e)&&(n[o]=a)}return n}),Nt=g(function(e,t){var n,r=t[0];return D(r)?(r=st(r),t.length>1&&(n=t[1])):(t=mt(tt(t,!1,!1),String),r=function(e,n){return!Tt(t,n)}),Ht(e,r,n)});function Ft(e,t,n){return o.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Kt(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:Ft(e,e.length-t)}function Wt(e,t,n){return o.call(e,null==t||n?1:t)}var zt=g(function(e,t){return t=tt(t,!0,!0),jt(e,function(e){return!Tt(t,e)})}),Xt=g(function(e,t){return zt(e,t)});function Bt(e,t,n,r){O(t)||(r=n,n=t,t=!1),null!=n&&(n=ke(n,r));for(var i=[],s=[],o=0,a=J(e);o<a;o++){var l=e[o],c=n?n(l,o,e):l;t&&!n?(o&&s===c||i.push(l),s=c):n?Tt(s,c)||(s.push(c),i.push(l)):Tt(i,l)||i.push(l)}return i}var Ut=g(function(e){return Bt(tt(e,!0,!0))});function Vt(e){for(var t=e&&Rt(e,J).length||0,n=Array(t),r=0;r<t;r++)n[r]=xt(e,r);return n}var Gt=g(Vt);function qt(e,t){return e._chain?ne(t).chain():t}function Zt(e){return bt(ge(e),function(t){var n=ne[t]=e[t];ne.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),qt(this,n.apply(ne,e))}}),ne}bt(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];ne.prototype[e]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0]),qt(this,n)}}),bt(["concat","join","slice"],function(e){var t=n[e];ne.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),qt(this,e)}});var Yt=Zt({__proto__:null,VERSION:"1.13.4",restArguments:g,isObject:w,isNull:function(e){return null===e},isUndefined:j,isBoolean:O,isElement:function(e){return!(!e||1!==e.nodeType)},isString:T,isNumber:S,isDate:x,isRegExp:R,isError:I,isSymbol:P,isArrayBuffer:A,isDataView:N,isArray:F,isFunction:D,isArguments:z,isFinite:function(e){return!P(e)&&y(e)&&!isNaN(parseFloat(e))},isNaN:X,isTypedArray:Y,isEmpty:function(e){if(null==e)return!0;var t=J(e);return"number"==typeof t&&(F(e)||T(e)||z(e))?0===t:0===J(ee(e))},isMatch:te,isEqual:function(e,t){return se(e,t)},isMap:ve,isWeakMap:pe,isSet:ye,isWeakSet:be,keys:ee,allKeys:oe,values:me,pairs:function(e){for(var t=ee(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},invert:_e,functions:ge,methods:ge,extend:je,extendOwn:Oe,assign:Oe,defaults:Ee,create:function(e,t){var n=Te(e);return t&&Oe(n,t),n},clone:function(e){return w(e)?F(e)?e.slice():je({},e):e},tap:function(e,t){return t(e),e},get:Ie,has:function(e,t){for(var n=(t=xe(t)).length,r=0;r<n;r++){var i=t[r];if(!K(e,i))return!1;e=e[i]}return!!n},mapObject:function(e,t,n){t=ke(t,n);for(var r=ee(e),i=r.length,s={},o=0;o<i;o++){var a=r[o];s[a]=t(e[a],a,e)}return s},identity:Pe,constant:B,noop:$e,toPath:Se,property:Me,propertyOf:function(e){return null==e?$e:function(t){return Ie(e,t)}},matcher:Ae,matches:Ae,times:function(e,t,n){var r=Array(Math.max(0,e));t=Ce(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},random:He,now:Ne,escape:We,unescape:ze,templateSettings:Xe,template:function(e,t,n){!t&&n&&(t=n),t=Ee({},t,ne.templateSettings);var r=RegExp([(t.escape||Be).source,(t.interpolate||Be).source,(t.evaluate||Be).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,a){return s+=e.slice(i,a).replace(Ve,Ge),i=a+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n";var o,a=t.variable;if(a){if(!qe.test(a))throw new Error("variable is not a bare identifier: "+a)}else s="with(obj||{}){\n"+s+"}\n",a="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{o=new Function(a,"_",s)}catch(e){throw e.source=s,e}var l=function(e){return o.call(this,e,ne)};return l.source="function("+a+"){\n"+s+"}",l},result:function(e,t,n){var r=(t=xe(t)).length;if(!r)return D(n)?n.call(e):n;for(var i=0;i<r;i++){var s=null==e?void 0:e[t[i]];void 0===s&&(s=n,i=r),e=D(s)?s.call(e):s}return e},uniqueId:function(e){var t=++Ze+"";return e?e+t:t},chain:function(e){var t=ne(e);return t._chain=!0,t},iteratee:Le,partial:Je,bind:Qe,bindAll:nt,memoize:function(e,t){var n=function(r){var i=n.cache,s=""+(t?t.apply(this,arguments):r);return K(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return n.cache={},n},delay:rt,defer:it,throttle:function(e,t,n){var r,i,s,o,a=0;n||(n={});var l=function(){a=!1===n.leading?0:Ne(),r=null,o=e.apply(i,s),r||(i=s=null)},c=function(){var c=Ne();a||!1!==n.leading||(a=c);var u=t-(c-a);return i=this,s=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),a=c,o=e.apply(i,s),r||(i=s=null)):r||!1===n.trailing||(r=setTimeout(l,u)),o};return c.cancel=function(){clearTimeout(r),a=0,r=i=s=null},c},debounce:function(e,t,n){var r,i,s,o,a,l=function(){var c=Ne()-i;t>c?r=setTimeout(l,t-c):(r=null,n||(o=e.apply(a,s)),r||(s=a=null))},c=g(function(c){return a=this,s=c,i=Ne(),r||(r=setTimeout(l,t),n&&(o=e.apply(a,s))),o});return c.cancel=function(){clearTimeout(r),r=s=a=null},c},wrap:function(e,t){return Je(t,e)},negate:st,compose:function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:ot,once:at,findKey:lt,findIndex:ut,findLastIndex:ft,sortedIndex:dt,indexOf:vt,lastIndexOf:pt,find:yt,detect:yt,findWhere:function(e,t){return yt(e,Ae(t))},each:bt,forEach:bt,map:mt,collect:mt,reduce:gt,foldl:gt,inject:gt,reduceRight:wt,foldr:wt,filter:jt,select:jt,reject:function(e,t,n){return jt(e,st(ke(t)),n)},every:Ot,all:Ot,some:Et,any:Et,contains:Tt,includes:Tt,include:Tt,invoke:St,pluck:xt,where:function(e,t){return jt(e,Ae(t))},max:Rt,min:function(e,t,n){var r,i,s=1/0,o=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=et(e)?e:me(e)).length;a<l;a++)null!=(r=e[a])&&r<s&&(s=r);else t=ke(t,n),bt(e,function(e,n,r){((i=t(e,n,r))<o||i===1/0&&s===1/0)&&(s=e,o=i)});return s},shuffle:function(e){return At(e,1/0)},sample:At,sortBy:function(e,t,n){var r=0;return t=ke(t,n),xt(mt(e,function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")},groupBy:Ct,indexBy:Dt,countBy:Lt,partition:kt,toArray:Pt,size:function(e){return null==e?0:et(e)?e.length:ee(e).length},pick:Ht,omit:Nt,first:Kt,head:Kt,take:Kt,initial:Ft,last:function(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:Wt(e,Math.max(0,e.length-t))},rest:Wt,tail:Wt,drop:Wt,compact:function(e){return jt(e,Boolean)},flatten:function(e,t){return tt(e,t,!1)},without:Xt,uniq:Bt,unique:Bt,union:Ut,intersection:function(e){for(var t=[],n=arguments.length,r=0,i=J(e);r<i;r++){var s=e[r];if(!Tt(t,s)){var o;for(o=1;o<n&&Tt(arguments[o],s);o++);o===n&&t.push(s)}}return t},difference:zt,unzip:Vt,transpose:Vt,zip:Gt,object:function(e,t){for(var n={},r=0,i=J(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},range:function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),s=0;s<r;s++,e+=n)i[s]=e;return i},chunk:function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(o.call(e,r,r+=t));return n},mixin:Zt,default:ne});return Yt._=Yt,Yt})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});
//# sourceMappingURL=timeline-visualizer.min.js.map
