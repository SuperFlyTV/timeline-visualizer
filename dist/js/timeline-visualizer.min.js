!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).TimelineVisualizer=e()}}(function(){return function(){return function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return i(t[o][1][e]||e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}}()({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("tslib").__exportStar(e("./lib/timelineVisualizer"),n)},{"./lib/timelineVisualizer":2,tslib:14}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e("lodash.isequal"),i=e("lodash.merge"),a=e("superfly-timeline"),o=e("events"),s=1,l=.25,u=100,c=1.001,f=10,h=60,d=1,v="#333333",p="#666666",y="#999999",_=1,m="rgba(255, 0, 0, 0.5)",b=5,w="black",g=1,j="Calibri",O=16,E="white",T="rgb(22, 102, 247, 0.75)",S="rgba(232, 240, 255, 0.85)",x=1,A=1,R=0,M=1;n.TimelineVisualizer=class extends o.EventEmitter{constructor(e,t={}){super(),this.stepSize=s,this._layerLabelWidthProportionOfCanvas=l,this._layerLabels={},this._timelineState={},this._hoveredObjectMap={},this._viewStartTime=0,this._mouseDown=!1,this._timelineZoom=u,this._playHeadPlaying=!1,this._playSpeed=d,this._playHeadTime=0,this._updateDrawLastTime=0,this._lastHoverAction=M,this._lastHoveredName="",this._timelineResolveAuto=!1,this._timelineResolveStart=0,this._timelineResolveEnd=0,this._timelineResolveZoom=1,this._timelineResolveCount=100,this._timelineResolveCountAdjust=1,this._timelineResolveExpand=3,this.latestUpdateTime=0,this.reresolveTimeout=null,this._canvasId=e,this.initCanvas(),this._drawPlayhead=!!t.drawPlayhead,this._layerLabelWidth=this._canvasWidth*this._layerLabelWidthProportionOfCanvas,this._viewDrawX=this._layerLabelWidth,this._viewDrawWidth=this._canvasWidth-this._layerLabelWidth,this.drawBackground(),this.drawPlayhead(),this.updateDraw()}initCanvas(){if(this._canvasContainer=document.getElementById(this._canvasId),!this._canvasContainer)throw new Error(`Canvas "${this._canvasId}" not found`);this._canvas=this._canvasContainer.getContext("2d"),this._canvasContainer.addEventListener("mousedown",e=>this.canvasMouseDown(e)),this._canvasContainer.addEventListener("mouseup",e=>this.canvasMouseUp(e)),this._canvasContainer.addEventListener("mousemove",e=>this.canvasMouseMove(e)),this._canvasContainer.addEventListener("wheel",e=>this.canvasScrollWheel(e)),this._canvasWidth=this._canvasContainer.width,this._canvasHeight=this._canvasContainer.height}updateTimeline(e,t){void 0===t&&(t={time:0,limitCount:10}),this.latestTimeline=e,this.latestOptions=t,t.limitTime?this._timelineResolveAuto=!1:this._timelineResolveAuto=!0;const n=Object.assign({},t);this._timelineResolveAuto&&this.updateTimelineResolveWindow(),void 0===this._resolvedStates&&(void 0!==n.time&&(this._viewStartTime=n.time),this._playHeadTime=this._viewStartTime),this._updateTimeline()}_updateTimeline(){const e=Object.assign({},this.latestOptions);this._timelineResolveAuto&&(e.time=this._timelineResolveStart,e.limitTime=this._timelineResolveEnd,e.limitCount=Math.ceil(this._timelineResolveCount*this._timelineResolveCountAdjust));const t=Date.now(),n=a.Resolver.resolveTimeline(this.latestTimeline,e),r=a.Resolver.resolveAllStates(n);void 0===this._resolvedStates?this._resolvedStates=r:(this._drawPlayhead&&(e.time=this._playHeadTime),this._drawPlayhead?r&&(this._resolvedStates=this.trimTimeline(this._resolvedStates,{end:this._playHeadTime}),this._resolvedStates=this.mergeTimelineObjects(this._resolvedStates,r)):this._resolvedStates=r),this.updateLayerLabels(),this.latestUpdateTime=Date.now()-t,this.redrawTimeline(),this.latestUpdateTime=Date.now()-t}setViewPort(e){let t=!1;if(void 0!==e.zoom&&(this._timelineZoom=e.zoom,t=!0),void 0!==e.timestamp&&e.timestamp>0&&(this._viewStartTime=e.timestamp,t=!0),void 0!==e.playViewPort&&(this._playViewPort=e.playViewPort),void 0!==e.playSpeed){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playSpeed was set, but drawPlayhead was not set in constructor");this._playSpeed=e.playSpeed}if(void 0!==e.playPlayhead){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playPlayhead was set, but drawPlayhead was not set in constructor");this._playHeadPlaying=e.playPlayhead}if(void 0!==e.playheadTime){if(!this._drawPlayhead)throw new Error("setViewPort: viewPort.playheadTime was set, but drawPlayhead was not set in constructor");this._playHeadTime=Math.max(0,e.playheadTime),this._playHeadTime>0&&(this._updateDrawLastTime=this._playHeadTime),t=!0}!0===t&&this.redrawTimeline()}getHoveredObject(){return this._hoveredOver}calculateRowHeight(e){return Math.min(h,this._canvasHeight/Object.keys(e).length)}updateLayerLabels(){const e=this.getLayersToDraw();r(this._layerLabels,e.layers)||(this._layerLabels=e.layers,this._rowHeight=this.calculateRowHeight(this._layerLabels),this._timelineObjectHeight=this._rowHeight*A,this._numberOfLayers=Object.keys(this._layerLabels).length,this._rowsTotalHeight=this._rowHeight*this._numberOfLayers)}drawLayerLabels(){let e=0;for(let t of Object.keys(this._layerLabels))this._canvas.fillStyle=p,this._canvas.fillRect(0,e*this._rowHeight,this._layerLabelWidth,this._rowHeight),this._canvas.fillStyle=E,this._canvas.font=O.toString()+"px "+j,this._canvas.textBaseline="middle",this._canvas.fillText(t,0,e*this._rowHeight+this._rowHeight/2,this._layerLabelWidth),0!==this._layerLabels[t]&&(this._canvas.fillStyle=w,this._canvas.fillRect(this._layerLabelWidth,e*this._rowHeight,this._viewDrawWidth,g)),e++}drawBackground(){this._canvas.fillStyle=v,this._canvas.fillRect(0,0,this._canvasWidth,this._canvasHeight),this.drawBackgroundRuler()}drawBackgroundRuler(){const e=this.viewRange,t=this.viewEndTime,n=Math.pow(10,Math.floor(Math.log10(e/5))),r=10*n,i=Math.floor(e/n),a=n,o=Math.floor(this._viewStartTime/n)*n,s=Math.min(1,5/i);if(a){this._canvas.strokeStyle=y,this._canvas.lineWidth=_;for(let e=o;e<t;e+=a){this._canvas.beginPath();let t=this.timeToXCoord(e),n=e/r%1;n>.5&&(n-=1),n=Math.abs(n),this._canvas.globalAlpha=n<.01?1:s,t>=this._viewDrawX&&(this._canvas.moveTo(t,0),this._canvas.lineTo(t,this._canvasHeight)),this._canvas.stroke()}this._canvas.globalAlpha=1}}drawPlayhead(){this._drawPlayhead&&this.istimeInView(this._playHeadTime)&&(this._canvas.fillStyle=m,this._canvas.fillRect(this.timeToXCoord(this._playHeadTime),0,b,this._canvasHeight))}getLayersToDraw(){this._hoveredObjectMap={};let e=[];if(this._resolvedStates)for(let t=0;t<Object.keys(this._resolvedStates.layers).length;t++){let n=Object.keys(this._resolvedStates.layers)[t];-1===e.indexOf(n)&&e.push(n)}let t={};return e.forEach((e,n)=>{t[e]=n,this._hoveredObjectMap[e]=[]}),{layers:t,layersArray:e}}redrawTimeline(){this._canvas.clearRect(0,0,this._canvasWidth,this._canvasHeight),this.drawBackground(),this.drawLayerLabels(),this._timelineState=this.getTimelineDrawState(this._resolvedStates),this.drawTimelineState(this._timelineState),this.drawPlayhead(),this.checkAutomaticReresolve()}drawTimelineState(e){for(let t in e)e[t].visible&&(this._canvas.fillStyle=T,this._canvas.fillRect(e[t].left,e[t].top,e[t].width,e[t].height),this._canvas.strokeStyle=S,this._canvas.lineWidth=x,this._canvas.strokeRect(e[t].left,e[t].top,e[t].width,e[t].height),this._canvas.fillStyle=E,this._canvas.font=O.toString()+"px "+j,this._canvas.textBaseline="top",this._canvas.fillText(t.split(":")[1],e[t].left,e[t].top))}getTimelineDrawState(e){let t={};if(e)for(let n in e.objects){let r=e.objects[n],i=r.id;for(let e=0;e<r.resolved.instances.length;e++){let n=r.resolved.instances[e],a="timelineObject:"+i+":"+n.id;t[a]=this.createStateForObject(r.layer+"",n.start,n.end),!0===t[a].visible&&this._hoveredObjectMap[r.layer+""].push({startX:t[a].left,endX:t[a].left+t[a].width,name:a})}}return t}createStateForObject(e,t,n){let r={height:0,left:0,top:0,width:0,visible:!1};if(this.showOnTimeline(t,n)){let i=this.getObjectWidth(t,n),a=this.capXcoordToView(this.timeToXCoord(t)),o=this.getObjectOffsetFromTop(e);r.height=this._timelineObjectHeight,r.left=a,r.top=o,r.width=i,r.visible=!0}return r}getObjectWidth(e,t){return t?(e<this._viewStartTime&&(e=this._viewStartTime),(t-e)*this.pixelsWidthPerUnitTime):this._canvasWidth}showOnTimeline(e,t){let n=e>=this.viewEndTime,r=(t||1/0)<=this._viewStartTime;return!n&&!r}getObjectOffsetFromTop(e){return this._layerLabels[e]*this._rowHeight}updateDraw(){const e=Date.now(),t=(this._updateDrawLastTime>0?e-this._updateDrawLastTime:1)/1e3;this._updateDrawLastTime=e;const n=this._playSpeed*t;let r=!1;this._playHeadPlaying&&this._drawPlayhead&&(this._playViewPort&&this.istimeInView(this._playHeadTime)&&(this._viewStartTime+=n),this._playHeadTime+=n,r=!0),r&&this.redrawTimeline(),window.requestAnimationFrame(()=>this.updateDraw())}canvasMouseDown(e){this._mouseDown=!0,this._mouseLastX=e.clientX,e.preventDefault(),e.stopPropagation()}canvasMouseUp(e){this._mouseDown=!1,this._lastScrollDirection=0,e.preventDefault(),e.stopPropagation()}canvasMouseMove(e){if(this._mouseDown){if(void 0===this._lastScrollDirection||0===this._lastScrollDirection){this._mouseLastX=e.clientX;let t=e.clientX-this._mouseLastX;this._lastScrollDirection=t<0?-1:1,this.canvasScrollByDeltaX(-t)}else{let t=this._mouseLastX-e.clientX;if(t<0&&1===this._lastScrollDirection)this._mouseLastX=e.clientX,this._lastScrollDirection=-1;else if(t>0&&-1===this._lastScrollDirection)this._mouseLastX=e.clientX,this._lastScrollDirection=1;else{let t=e.clientX-this._mouseLastX;this._mouseLastX=e.clientX,this.canvasScrollByDeltaX(-t)}}this.redrawTimeline()}else{let t=!1,n=this.getMousePos(this._canvasContainer,e);if(n.x>this._viewDrawX&&n.y<this._rowsTotalHeight){let e,r=Math.floor(n.y/this._rowsTotalHeight*this._numberOfLayers);Object.keys(this._layerLabels).forEach(t=>{this._layerLabels[t]===r&&(e=t)}),((e?this._hoveredObjectMap[e]:[])||[]).forEach(e=>{if(e.startX<=n.x&&e.endX>=n.x&&(t=!0,this._lastHoveredName!==e.name)){let t=this.timelineMetaFromString(e.name);if(void 0!==t&&"timelineObject"===t.type&&this._resolvedStates){let r=this._resolvedStates.objects[t.name],i=r.resolved.instances.find(e=>e.id===t.instance),a={object:r,instance:i,pointer:{xPostion:n.x,yPosition:n.y}};this._hoveredOver=a,this.emit("timeline:hover",{detail:this._hoveredOver}),this._lastHoverAction=R,this._lastHoveredName=e.name}}})}t||this._lastHoverAction!==R||(this.emit("timeline:hover",{detail:void 0}),this._lastHoverAction=M)}}canvasScrollWheel(e){let t=this.getMousePos(this._canvasContainer,e);if(t.x<=this._viewDrawX)return;let n=!1;if(!0===e.ctrlKey){if(e.deltaY){n=!0;const r=Math.pow(c,-e.deltaY);this.zoomUnderCursor(t.x,r)}}else 0!==e.deltaX?(n=!0,this.canvasScrollByDeltaX(e.deltaX*(f*this.stepSize))):0!==e.deltaY&&!0===e.altKey&&(n=!0,this.canvasScrollByDeltaX(e.deltaY*(f*this.stepSize)));e.preventDefault(),e.stopPropagation(),n&&this.redrawTimeline()}canvasScrollByDeltaX(e){let t=this._viewStartTime+e/this.pixelsWidthPerUnitTime;t<0&&(t=0),t!==this._viewStartTime&&(this._viewStartTime=t)}zoomUnderCursor(e,t){let n=this.xCoordToTime(e),r=this.timeToRatio(n);this._timelineZoom=this._timelineZoom*t;let i=n-(r=Math.max(0,Math.min(1,r)))*this.viewRange;i<0&&(i=0),this._viewStartTime=i}getMousePos(e,t){const n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}trimTimeline(e,t){let n={};return Object.keys(e.objects).forEach(r=>{const i=e.objects[r];i.resolved.instances.forEach(e=>{let a=!1,o=Object.assign({},e);if(t.start&&(e.end||1/0)>t.start&&(a=!0,o.start<t.start&&(o.start=t.start)),t.end&&e.start<t.end&&(a=!0,(o.end||1/0)>t.end&&(o.end=t.end)),a&&o.start<(o.end||1/0))if(-1===Object.keys(n).indexOf(r)){let e={content:i.content,enable:i.enable,id:i.id,layer:i.layer,resolved:{instances:[o],levelDeep:i.resolved.levelDeep,resolved:i.resolved.resolved,resolving:i.resolved.resolving}};n[r]=e}else n[r].resolved.instances.push(o)})}),{classes:e.classes,layers:e.layers,objects:n,options:e.options,statistics:e.statistics}}mergeTimelineObjects(e,t){return Object.keys(e.objects).forEach(n=>{const i=e.objects[n];if(n in t.objects){const e=t.objects[n];r(Object.assign({},i,{resolved:null}),Object.assign({},e,{resolved:null}))&&i.resolved.instances.forEach(t=>{e.resolved.instances.forEach(e=>{t.end===e.start&&(e.start=t.start,i.resolved.instances.splice(i.resolved.instances.indexOf(e),1))})})}}),i(e,t)}timelineMetaFromString(e){let t=e.split(":");if(3===t.length)return{type:t[0],name:t[1],instance:t[2]}}updateTimelineResolveWindow(){const{start:e,end:t}=this.getExpandedStartEndTime(1);if(this._timelineResolveStart=e,this._timelineResolveEnd=t,this._timelineResolveZoom=this._timelineZoom,this.latestUpdateTime){let e=50/this.latestUpdateTime;this._timelineResolveCountAdjust=Math.max(.1,Math.min(10,(1+this._timelineResolveCountAdjust*e)/2))}}getExpandedStartEndTime(e=1){let t=this._viewStartTime,n=this.viewEndTime,r=(n-t)*(this._timelineResolveExpand-1)*e;return t-=.33*r,n+=.66*r,{start:t=Math.max(0,t),end:n=Math.max(0,n),zoomDiff:Math.max(this._timelineResolveZoom,this._timelineZoom)/Math.min(this._timelineResolveZoom,this._timelineZoom)}}checkAutomaticReresolve(){const{start:e,end:t,zoomDiff:n}=this.getExpandedStartEndTime(.2);this._timelineResolveAuto&&(e<this._timelineResolveStart||t>this._timelineResolveEnd||n>3)&&(this.reresolveTimeout||(this.reresolveTimeout=setTimeout(()=>{this.reresolveTimeout=null,this.updateTimelineResolveWindow(),this._updateTimeline()},Math.max(100,5*this.latestUpdateTime))))}timeToXCoord(e){return this._viewDrawX+(e-this._viewStartTime)*this.pixelsWidthPerUnitTime}xCoordToTime(e){return this._viewStartTime+(e-this._viewDrawX)/this.pixelsWidthPerUnitTime}timeToRatio(e){return(e-this._viewStartTime)/this.viewRange}istimeInView(e){const t=this.timeToRatio(e);return t>=0&&t<1}capXcoordToView(e){return Math.max(this._viewDrawX,Math.min(this._viewDrawX+this._viewDrawWidth,e))}get pixelsWidthPerUnitTime(){return this._timelineZoom/100}get viewRange(){return this._viewDrawWidth/this.pixelsWidthPerUnitTime}get viewEndTime(){return this._viewStartTime+this.viewRange}}},{events:3,"lodash.isequal":4,"lodash.merge":5,"superfly-timeline":7}],3:[function(e,t,n){var r=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},a=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function o(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0;var s,l=10;try{var u={};Object.defineProperty&&Object.defineProperty(u,"x",{value:0}),s=0===u.x}catch(e){s=!1}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,i){var a,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=r(null),e._eventsCount=0),s){if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(a=c(e))&&a>0&&s.length>a){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else s=o[t]=n,++e._eventsCount;return e}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=a.call(h,r);return i.listener=n,r.wrapFn=i,i}function v(e,t,n){var r=e._events;if(!r)return[];var i=r[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length):[]}function p(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}s?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');l=e}}):o.defaultMaxListeners=l,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){var t,n,r,i,a,o,s="error"===e;if(o=this._events)s=s&&null==o.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=y(e,r),a=0;a<r;++a)i[a].call(n)}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,a=y(e,i),o=0;o<i;++o)a[o].call(n,r)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var a=e.length,o=y(e,a),s=0;s<a;++s)o[s].call(n,r,i)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,a){if(t)e.call(n,r,i,a);else for(var o=e.length,s=y(e,o),l=0;l<o;++l)s[l].call(n,r,i,a)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,a=y(e,i),o=0;o<i;++o)a[o].apply(n,r)}(n,u,this,i)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,a,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=r(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,a=o;break}if(a<0)return this;0===a?n.shift():function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,a),1===n.length&&(i[e]=n[0]),i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.removeAllListeners=function(e){var t,n,a;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=r(null):delete n[e]),this;if(0===arguments.length){var o,s=i(n);for(a=0;a<s.length;++a)"removeListener"!==(o=s[a])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this},o.prototype.listeners=function(e){return v(this,e,!0)},o.prototype.rawListeners=function(e){return v(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],4:[function(e,t,n){(function(e){var r=200,i="__lodash_hash_undefined__",a=1,o=2,s=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",f="[object Boolean]",h="[object Date]",d="[object Error]",v="[object Function]",p="[object GeneratorFunction]",y="[object Map]",_="[object Number]",m="[object Null]",b="[object Object]",w="[object Proxy]",g="[object RegExp]",j="[object Set]",O="[object String]",E="[object Symbol]",T="[object Undefined]",S="[object ArrayBuffer]",x="[object DataView]",A=/^\[object .+?Constructor\]$/,R=/^(?:0|[1-9]\d*)$/,M={};M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M[l]=M[u]=M[S]=M[f]=M[x]=M[h]=M[d]=M[v]=M[y]=M[_]=M[b]=M[g]=M[j]=M[O]=M["[object WeakMap]"]=!1;var P="object"==typeof e&&e&&e.Object===Object&&e,L="object"==typeof self&&self&&self.Object===Object&&self,k=P||L||Function("return this")(),D="object"==typeof n&&n&&!n.nodeType&&n,I=D&&"object"==typeof t&&t&&!t.nodeType&&t,C=I&&I.exports===D,z=C&&P.process,F=function(){try{return z&&z.binding&&z.binding("util")}catch(e){}}(),N=F&&F.isTypedArray;function W(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function H(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function K(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var X,U,B,$=Array.prototype,V=Function.prototype,q=Object.prototype,G=k["__core-js_shared__"],Z=V.toString,Y=q.hasOwnProperty,J=(X=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+X:"",Q=q.toString,ee=RegExp("^"+Z.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=C?k.Buffer:void 0,ne=k.Symbol,re=k.Uint8Array,ie=q.propertyIsEnumerable,ae=$.splice,oe=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ue=(U=Object.keys,B=Object,function(e){return U(B(e))}),ce=Fe(k,"DataView"),fe=Fe(k,"Map"),he=Fe(k,"Promise"),de=Fe(k,"Set"),ve=Fe(k,"WeakMap"),pe=Fe(Object,"create"),ye=Ke(ce),_e=Ke(fe),me=Ke(he),be=Ke(de),we=Ke(ve),ge=ne?ne.prototype:void 0,je=ge?ge.valueOf:void 0;function Oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Se(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Te;++t<n;)this.add(e[t])}function xe(e){var t=this.__data__=new Ee(e);this.size=t.size}function Ae(e,t){var n=Be(e),r=!n&&Ue(e),i=!n&&!r&&$e(e),a=!n&&!r&&!i&&Ye(e),o=n||r||i||a,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var u in e)!t&&!Y.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||He(u,l))||s.push(u);return s}function Re(e,t){for(var n=e.length;n--;)if(Xe(e[n][0],t))return n;return-1}function Me(e){return null==e?void 0===e?T:m:oe&&oe in Object(e)?function(e){var t=Y.call(e,oe),n=e[oe];try{e[oe]=void 0;var r=!0}catch(e){}var i=Q.call(e);r&&(t?e[oe]=n:delete e[oe]);return i}(e):function(e){return Q.call(e)}(e)}function Pe(e){return Ze(e)&&Me(e)==l}function Le(e,t,n,r,i){return e===t||(null==e||null==t||!Ze(e)&&!Ze(t)?e!=e&&t!=t:function(e,t,n,r,i,s){var c=Be(e),v=Be(t),p=c?u:We(e),m=v?u:We(t),w=(p=p==l?b:p)==b,T=(m=m==l?b:m)==b,A=p==m;if(A&&$e(e)){if(!$e(t))return!1;c=!0,w=!1}if(A&&!w)return s||(s=new xe),c||Ye(e)?Ie(e,t,n,r,i,s):function(e,t,n,r,i,s,l){switch(n){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case f:case h:case _:return Xe(+e,+t);case d:return e.name==t.name&&e.message==t.message;case g:case O:return e==t+"";case y:var u=H;case j:var c=r&a;if(u||(u=K),e.size!=t.size&&!c)return!1;var v=l.get(e);if(v)return v==t;r|=o,l.set(e,t);var p=Ie(u(e),u(t),r,i,s,l);return l.delete(e),p;case E:if(je)return je.call(e)==je.call(t)}return!1}(e,t,p,n,r,i,s);if(!(n&a)){var R=w&&Y.call(e,"__wrapped__"),M=T&&Y.call(t,"__wrapped__");if(R||M){var P=R?e.value():e,L=M?t.value():t;return s||(s=new xe),i(P,L,n,r,s)}}if(!A)return!1;return s||(s=new xe),function(e,t,n,r,i,o){var s=n&a,l=Ce(e),u=l.length,c=Ce(t).length;if(u!=c&&!s)return!1;for(var f=u;f--;){var h=l[f];if(!(s?h in t:Y.call(t,h)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var v=!0;o.set(e,t),o.set(t,e);for(var p=s;++f<u;){h=l[f];var y=e[h],_=t[h];if(r)var m=s?r(_,y,h,t,e,o):r(y,_,h,e,t,o);if(!(void 0===m?y===_||i(y,_,n,r,o):m)){v=!1;break}p||(p="constructor"==h)}if(v&&!p){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(v=!1)}return o.delete(e),o.delete(t),v}(e,t,n,r,i,s)}(e,t,n,r,Le,i))}function ke(e){return!(!Ge(e)||(t=e,J&&J in t))&&(Ve(e)?ee:A).test(Ke(e));var t}function De(e){if(n=(t=e)&&t.constructor,r="function"==typeof n&&n.prototype||q,t!==r)return ue(e);var t,n,r,i=[];for(var a in Object(e))Y.call(e,a)&&"constructor"!=a&&i.push(a);return i}function Ie(e,t,n,r,i,s){var l=n&a,u=e.length,c=t.length;if(u!=c&&!(l&&c>u))return!1;var f=s.get(e);if(f&&s.get(t))return f==t;var h=-1,d=!0,v=n&o?new Se:void 0;for(s.set(e,t),s.set(t,e);++h<u;){var p=e[h],y=t[h];if(r)var _=l?r(y,p,h,t,e,s):r(p,y,h,e,t,s);if(void 0!==_){if(_)continue;d=!1;break}if(v){if(!W(t,function(e,t){if(a=t,!v.has(a)&&(p===e||i(p,e,n,r,s)))return v.push(t);var a})){d=!1;break}}else if(p!==y&&!i(p,y,n,r,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function Ce(e){return function(e,t,n){var r=t(e);return Be(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Je,Ne)}function ze(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Fe(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ke(n)?n:void 0}Oe.prototype.clear=function(){this.__data__=pe?pe(null):{},this.size=0},Oe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Oe.prototype.get=function(e){var t=this.__data__;if(pe){var n=t[e];return n===i?void 0:n}return Y.call(t,e)?t[e]:void 0},Oe.prototype.has=function(e){var t=this.__data__;return pe?void 0!==t[e]:Y.call(t,e)},Oe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=pe&&void 0===t?i:t,this},Ee.prototype.clear=function(){this.__data__=[],this.size=0},Ee.prototype.delete=function(e){var t=this.__data__,n=Re(t,e);return!(n<0||(n==t.length-1?t.pop():ae.call(t,n,1),--this.size,0))},Ee.prototype.get=function(e){var t=this.__data__,n=Re(t,e);return n<0?void 0:t[n][1]},Ee.prototype.has=function(e){return Re(this.__data__,e)>-1},Ee.prototype.set=function(e,t){var n=this.__data__,r=Re(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Te.prototype.clear=function(){this.size=0,this.__data__={hash:new Oe,map:new(fe||Ee),string:new Oe}},Te.prototype.delete=function(e){var t=ze(this,e).delete(e);return this.size-=t?1:0,t},Te.prototype.get=function(e){return ze(this,e).get(e)},Te.prototype.has=function(e){return ze(this,e).has(e)},Te.prototype.set=function(e,t){var n=ze(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,i),this},Se.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.clear=function(){this.__data__=new Ee,this.size=0},xe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xe.prototype.get=function(e){return this.__data__.get(e)},xe.prototype.has=function(e){return this.__data__.has(e)},xe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ee){var i=n.__data__;if(!fe||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Te(i)}return n.set(e,t),this.size=n.size,this};var Ne=se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}(se(e),function(t){return ie.call(e,t)}))}:function(){return[]},We=Me;function He(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||R.test(e))&&e>-1&&e%1==0&&e<t}function Ke(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Xe(e,t){return e===t||e!=e&&t!=t}(ce&&We(new ce(new ArrayBuffer(1)))!=x||fe&&We(new fe)!=y||he&&"[object Promise]"!=We(he.resolve())||de&&We(new de)!=j||ve&&"[object WeakMap]"!=We(new ve))&&(We=function(e){var t=Me(e),n=t==b?e.constructor:void 0,r=n?Ke(n):"";if(r)switch(r){case ye:return x;case _e:return y;case me:return"[object Promise]";case be:return j;case we:return"[object WeakMap]"}return t});var Ue=Pe(function(){return arguments}())?Pe:function(e){return Ze(e)&&Y.call(e,"callee")&&!ie.call(e,"callee")},Be=Array.isArray;var $e=le||function(){return!1};function Ve(e){if(!Ge(e))return!1;var t=Me(e);return t==v||t==p||t==c||t==w}function qe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function Ge(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ze(e){return null!=e&&"object"==typeof e}var Ye=N?function(e){return function(t){return e(t)}}(N):function(e){return Ze(e)&&qe(e.length)&&!!M[Me(e)]};function Je(e){return null!=(t=e)&&qe(t.length)&&!Ve(t)?Ae(e):De(e);var t}t.exports=function(e,t){return Le(e,t)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){(function(e){var r=200,i="__lodash_hash_undefined__",a=800,o=16,s=9007199254740991,l="[object Arguments]",u="[object AsyncFunction]",c="[object Function]",f="[object GeneratorFunction]",h="[object Null]",d="[object Object]",v="[object Proxy]",p="[object Undefined]",y=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[l]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m[c]=m["[object Map]"]=m["[object Number]"]=m[d]=m["[object RegExp]"]=m["[object Set]"]=m["[object String]"]=m["[object WeakMap]"]=!1;var b="object"==typeof e&&e&&e.Object===Object&&e,w="object"==typeof self&&self&&self.Object===Object&&self,g=b||w||Function("return this")(),j="object"==typeof n&&n&&!n.nodeType&&n,O=j&&"object"==typeof t&&t&&!t.nodeType&&t,E=O&&O.exports===j,T=E&&b.process,S=function(){try{return T&&T.binding&&T.binding("util")}catch(e){}}(),x=S&&S.isTypedArray;function A(e,t){return"__proto__"==t?void 0:e[t]}var R,M,P,L=Array.prototype,k=Function.prototype,D=Object.prototype,I=g["__core-js_shared__"],C=k.toString,z=D.hasOwnProperty,F=(R=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+R:"",N=D.toString,W=C.call(Object),H=RegExp("^"+C.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),K=E?g.Buffer:void 0,X=g.Symbol,U=g.Uint8Array,B=K?K.allocUnsafe:void 0,$=(M=Object.getPrototypeOf,P=Object,function(e){return M(P(e))}),V=Object.create,q=D.propertyIsEnumerable,G=L.splice,Z=X?X.toStringTag:void 0,Y=function(){try{var e=je(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),J=K?K.isBuffer:void 0,Q=Math.max,ee=Date.now,te=je(g,"Map"),ne=je(Object,"create"),re=function(){function e(){}return function(t){if(!ke(t))return{};if(V)return V(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function ie(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ae(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function se(e){var t=this.__data__=new ae(e);this.size=t.size}function le(e,t){var n=Ae(e),r=!n&&xe(e),i=!n&&!r&&Me(e),a=!n&&!r&&!i&&Ie(e),o=n||r||i||a,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var u in e)!t&&!z.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Oe(u,l))||s.push(u);return s}function ue(e,t,n){(void 0===n||Se(e[t],n))&&(void 0!==n||t in e)||he(e,t,n)}function ce(e,t,n){var r=e[t];z.call(e,t)&&Se(r,n)&&(void 0!==n||t in e)||he(e,t,n)}function fe(e,t){for(var n=e.length;n--;)if(Se(e[n][0],t))return n;return-1}function he(e,t,n){"__proto__"==t&&Y?Y(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}ie.prototype.clear=function(){this.__data__=ne?ne(null):{},this.size=0},ie.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ie.prototype.get=function(e){var t=this.__data__;if(ne){var n=t[e];return n===i?void 0:n}return z.call(t,e)?t[e]:void 0},ie.prototype.has=function(e){var t=this.__data__;return ne?void 0!==t[e]:z.call(t,e)},ie.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ne&&void 0===t?i:t,this},ae.prototype.clear=function(){this.__data__=[],this.size=0},ae.prototype.delete=function(e){var t=this.__data__,n=fe(t,e);return!(n<0||(n==t.length-1?t.pop():G.call(t,n,1),--this.size,0))},ae.prototype.get=function(e){var t=this.__data__,n=fe(t,e);return n<0?void 0:t[n][1]},ae.prototype.has=function(e){return fe(this.__data__,e)>-1},ae.prototype.set=function(e,t){var n=this.__data__,r=fe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},oe.prototype.clear=function(){this.size=0,this.__data__={hash:new ie,map:new(te||ae),string:new ie}},oe.prototype.delete=function(e){var t=ge(this,e).delete(e);return this.size-=t?1:0,t},oe.prototype.get=function(e){return ge(this,e).get(e)},oe.prototype.has=function(e){return ge(this,e).has(e)},oe.prototype.set=function(e,t){var n=ge(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},se.prototype.clear=function(){this.__data__=new ae,this.size=0},se.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ae){var i=n.__data__;if(!te||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new oe(i)}return n.set(e,t),this.size=n.size,this};var de,ve=function(e,t,n){for(var r=-1,i=Object(e),a=n(e),o=a.length;o--;){var s=a[de?o:++r];if(!1===t(i[s],s,i))break}return e};function pe(e){return null==e?void 0===e?p:h:Z&&Z in Object(e)?function(e){var t=z.call(e,Z),n=e[Z];try{e[Z]=void 0;var r=!0}catch(e){}var i=N.call(e);r&&(t?e[Z]=n:delete e[Z]);return i}(e):function(e){return N.call(e)}(e)}function ye(e){return De(e)&&pe(e)==l}function _e(e){return!(!ke(e)||(t=e,F&&F in t))&&(Pe(e)?H:y).test(function(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function me(e){if(!ke(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ee(e),n=[];for(var r in e)("constructor"!=r||!t&&z.call(e,r))&&n.push(r);return n}function be(e,t,n,r,i){e!==t&&ve(t,function(a,o){if(ke(a))i||(i=new se),function(e,t,n,r,i,a,o){var s=A(e,n),l=A(t,n),u=o.get(l);if(u)return void ue(e,n,u);var c=a?a(s,l,n+"",e,t,o):void 0,f=void 0===c;if(f){var h=Ae(l),v=!h&&Me(l),p=!h&&!v&&Ie(l);c=l,h||v||p?Ae(s)?c=s:De(w=s)&&Re(w)?c=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(s):v?(f=!1,c=function(e,t){if(t)return e.slice();var n=e.length,r=B?B(n):new e.constructor(n);return e.copy(r),r}(l,!0)):p?(f=!1,y=l,_=!0?(m=y.buffer,b=new m.constructor(m.byteLength),new U(b).set(new U(m)),b):y.buffer,c=new y.constructor(_,y.byteOffset,y.length)):c=[]:function(e){if(!De(e)||pe(e)!=d)return!1;var t=$(e);if(null===t)return!0;var n=z.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&C.call(n)==W}(l)||xe(l)?(c=s,xe(s)?c=function(e){return function(e,t,n,r){var i=!n;n||(n={});var a=-1,o=t.length;for(;++a<o;){var s=t[a],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?he(n,s,l):ce(n,s,l)}return n}(e,Ce(e))}(s):(!ke(s)||r&&Pe(s))&&(c=function(e){return"function"!=typeof e.constructor||Ee(e)?{}:re($(e))}(l))):f=!1}var y,_,m,b;var w;f&&(o.set(l,c),i(c,l,r,a,o),o.delete(l));ue(e,n,c)}(e,t,o,n,be,r,i);else{var s=r?r(A(e,o),a,o+"",e,t,i):void 0;void 0===s&&(s=a),ue(e,o,s)}},Ce)}function we(e,t){return Te(function(e,t,n){return t=Q(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Q(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,t,Ne),e+"")}function ge(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function je(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return _e(n)?n:void 0}function Oe(e,t){var n=typeof e;return!!(t=null==t?s:t)&&("number"==n||"symbol"!=n&&_.test(e))&&e>-1&&e%1==0&&e<t}function Ee(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||D)}var Te=function(e){var t=0,n=0;return function(){var r=ee(),i=o-(r-n);if(n=r,i>0){if(++t>=a)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Y?function(e,t){return Y(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Ne);function Se(e,t){return e===t||e!=e&&t!=t}var xe=ye(function(){return arguments}())?ye:function(e){return De(e)&&z.call(e,"callee")&&!q.call(e,"callee")},Ae=Array.isArray;function Re(e){return null!=e&&Le(e.length)&&!Pe(e)}var Me=J||function(){return!1};function Pe(e){if(!ke(e))return!1;var t=pe(e);return t==c||t==f||t==u||t==v}function Le(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function ke(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function De(e){return null!=e&&"object"==typeof e}var Ie=x?function(e){return function(t){return e(t)}}(x):function(e){return De(e)&&Le(e.length)&&!!m[pe(e)]};function Ce(e){return Re(e)?le(e,!0):me(e)}var ze,Fe=(ze=function(e,t,n){be(e,t,n)},we(function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(i=ze.length>3&&"function"==typeof i?(r--,i):void 0,a&&function(e,t,n){if(!ke(n))return!1;var r=typeof t;return!!("number"==r?Re(n)&&Oe(t,n.length):"string"==r&&t in n)&&Se(n[t],e)}(t[0],t[1],a)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var o=t[n];o&&ze(e,o,n,i)}return e}));function Ne(e){return e}t.exports=Fe}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.KEYFRAME=2]="KEYFRAME"}(n.EventType||(n.EventType={}))},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("tslib").__exportStar(e("./api/enums"),n);var r=e("./resolver/resolver");n.Resolver=r.Resolver;var i=e("./resolver/validate");n.validateTimeline=i.validateTimeline,n.validateObject=i.validateObject,n.validateKeyframe=i.validateKeyframe},{"./api/enums":6,"./resolver/resolver":11,"./resolver/validate":13,tslib:14}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("underscore");function i(e){return null!==e&&(!!r.isNumber(e)||!!r.isString(e)&&!(!e.match(/^[0-9\.\-]+$/)||r.isNaN(parseFloat(e))))}function a(e){return e.sort(function(e,t){if(e.time>t.time)return 1;if(e.time<t.time)return-1;var n=e.data&&(e.data.id||e.data.instance&&e.data.instance.id),r=t.data&&(t.data.id||t.data.instance&&t.data.instance.id);if(n&&r&&n===r){if(e.value&&!t.value)return-1;if(!e.value&&t.value)return 1}return e.value&&!t.value?1:!e.value&&t.value?-1:0})}function o(e,t,n){void 0===n&&(n=!1);var i=[];return r.each(e,function(e){i.push({time:e.start,value:!0,data:{instance:e},references:e.references}),null!==e.end&&i.push({time:e.end,value:!1,data:{instance:e},references:e.references})}),s(i,t,n)}function s(e,t,n){void 0===n&&(n=!1),a(e);var i={},o=null,s=!1,l=[];return r.each(e,function(e){var a=e.data.id||e.data.instance.id,f=r.last(l);if(e.value?i[a]=e:delete i[a],r.keys(i).length){if(s=!0,!t&&e.value&&f&&null===f.end&&null!==o&&o!==a)f.end=e.time,l.push({id:d(),start:e.time,end:null,references:e.references}),o=a;else if(t||e.value||!f||o!==a)t&&!n&&f&&f.end===e.time?(f.end=null,f.references=u(f.references,e.references),c(f,e.data.instance.caps)):f&&null===f.end?(f.references=u(f.references,e.references),c(f,e.data.instance.caps)):(l.push({id:a,start:e.time,end:null,references:e.references,caps:e.data.instance.caps}),o=a);else{var h=r.reduce(i,function(e,t,n){return null===e||e.event.time<t.time?{event:t,id:n}:e},null);h&&(f.end=e.time,l.push({id:a+"_"+d(),start:e.time,end:null,references:h.event.references}),o=h.id)}f&&f.caps&&!f.caps.length&&delete f.caps}else f&&s&&(f.end=e.time),s=!1}),l}function l(e){return r.isObject(e)&&!r.isArray(e)&&void 0!==e.value&&r.isArray(e.references)&&null!==e}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.compact(r.uniq(r.reduce(e,function(e,t){return r.isString(t)?e.concat([t]):e.concat(t)},[]))).sort(function(e,t){return e>t?1:e<t?-1:0})}function c(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];r.each(f.apply(void 0,t),function(t){t.end&&e.end&&t.end>e.end&&i.push({id:t.id,start:0,end:t.end})}),e.caps=f(e.caps,i)}function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.uniq(r.compact(r.reduce(e,function(e,t){return void 0!==t?(e||[]).concat(t):e},[])),!1,function(e){return e.id})}n.extendMandadory=function(e,t){return r.extend(e,t)},n.isConstant=function(e){return!!(i(e)||r.isString(e)&&(e.match(/^true$/)||e.match(/^false$/)))},n.isNumeric=i,n.sortEvents=a,n.cleanInstances=o,n.convertEventsToInstances=s,n.invertInstances=function(e){if(e.length){e=o(e,!0,!0);var t=[];return 0!==e[0].start&&t.push({id:d(),isFirst:!0,start:0,end:null,references:u(e[0].references,e[0].id)}),r.each(e,function(e){var n=r.last(t);n&&(n.end=e.start),null!==e.end&&t.push({id:d(),start:e.end,end:null,references:u(e.references,e.id),caps:e.caps})}),t}return[{id:d(),isFirst:!0,start:0,end:null,references:[]}]},n.operateOnArrays=function(e,t,n){if(null===e||null===t)return null;if(l(e)&&l(t))return n(e,t);for(var i=[],a=Math.min(r.isArray(e)?e.length:1/0,r.isArray(t)?t.length:1/0),s=0;s<a;s++){var c=r.isArray(e)?e[s]:{id:"",start:e.value,end:e.value,references:e.references},h=r.isArray(t)?t[s]:{id:"",start:t.value,end:t.value,references:t.references},v=c.isFirst?{value:c.start,references:c.references}:h.isFirst?{value:h.start,references:h.references}:n({value:c.start,references:u(c.id,c.references)},{value:h.start,references:u(h.id,h.references)}),p=c.isFirst?null!==c.end?{value:c.end,references:c.references}:null:h.isFirst?null!==h.end?{value:h.end,references:h.references}:null:n(null!==c.end?{value:c.end,references:u(c.id,c.references)}:null,null!==h.end?{value:h.end,references:u(h.id,h.references)}:null);null!==v&&i.push({id:d(),start:v.value,end:null===p?null:p.value,references:u(v.references,null!==p?p.references:[]),caps:f(c.caps,h.caps)})}return o(i,!1)},n.applyRepeatingInstances=function(e,t,n){if(null===t||!t.value)return e;var i=t.value;l(e)&&(e=[{id:"",start:e.value,end:null,references:e.references}]);var a=[];return r.each(e,function(e){for(var o=Math.max(n.time-(n.time-e.start)%i,e.start),s=null===e.end?null:e.end+(o-e.start),l=(e.caps?r.find(e.caps,function(t){return-1!==e.references.indexOf(t.id)}):null)||null,c=n.limitCount||2,f=0;f<c&&!(n.limitTime&&o>=n.limitTime);f++){var h=l?Math.max(l.start,o):o,v=l&&null!==l.end&&null!==s?Math.min(l.end,s):s;(v||1/0)>h&&a.push({id:d(),start:h,end:v,references:u(e.id,e.references,t.references)}),o+=i,null!==s&&(s+=i)}}),o(a,!1)},n.capInstances=function(e,t){if(l(t)||null===t)return e;var n=[];return r.each(e,function(e){var i=null;if(r.each(t,function(t){e.start>=t.start&&e.start<(t.end||1/0)&&(null===i||(t.end||1/0)>(i.end||1/0))&&(i=t)}),i||r.each(t,function(t){(e.end||1/0)>t.start&&(e.end||1/0)<=(t.end||1/0)&&(null===i||(t.end||1/0)<(i.end||1/0))&&(i=t)}),i){var a=i,o=r.clone(e);null!==a.end&&(o.end||1/0)>a.end&&(o.end=a.end),(o.start||1/0)<a.start&&(o.start=a.start),n.push(o)}}),n},n.isReference=l,n.joinReferences=u,n.addCapsToResuming=c,n.joinCaps=f;var h=0;function d(){return"@"+(h++).toString(36)}n.getId=d,n.resetId=function(){h=0}},{underscore:15}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("underscore");n.addObjectToResolvedTimeline=function(e,t){e.objects[t.id]=t,t.classes&&r.each(t.classes,function(n){n&&(e.classes[n]||(e.classes[n]=[]),e.classes[n].push(t.id))}),t.layer&&(e.layers[t.layer]||(e.layers[t.layer]=[]),e.layers[t.layer].push(t.id))}},{underscore:15}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("underscore");function i(e,t){return-1!==e.indexOf(t)}function a(e){for(var t=0;t<e.length;t++)if("("===e[t]){var n=a(e.slice(t+1));e[t]=n.inner,e.splice.apply(e,[t+1,99999].concat(n.rest))}else{if(")"===e[t])return{inner:e.slice(0,t),rest:e.slice(t+1)};if("!"===e[t]){n=a(e.slice(t+1));e[t]=["","!"].concat(n.inner),e.splice.apply(e,[t+1,99999].concat(n.rest))}}return{inner:e,rest:[]}}n.OPERATORS=["&","|","+","-","*","/","%","!"],n.interpretExpression=function(e){if(r.isString(e)){var t=n.OPERATORS,o=r.map(t,function(e){return"\\"+e}).join("");e=e.replace(new RegExp("(["+o+"\\(\\)])","g")," $1 ");var s=r.compact(e.split(" "));if(0===s.length)return null;for(var l=s.length-2;l>=1;l--)"-"!==s[l]&&"+"!==s[l]||!i(t,s[l-1])||(s[l]=s[l]+s[l+1],s.splice(l+1,1));var u=a(s);if(u.rest.length)throw new Error("interpretExpression: syntax error: parentheses don't add up in \""+e+'".');if(u.inner.length%2!=1)throw new Error("interpretExpression: operands & operators don't add up: \""+u.inner.join(" ")+'".');var c=function e(t,n){if(!n||!n.length)throw new Error("words2Expression: syntax error: unbalanced expression");for(;1===n.length&&r.isArray(n[0]);)n=n[0];if(1===n.length)return n[0];var i=-1;if(r.each(t,function(e){-1===i&&(i=n.lastIndexOf(e))}),-1!==i){var a=n.slice(0,i),o=n.slice(i+1),s={l:e(t,a),o:n[i],r:e(t,o)};return s}throw new Error('words2Expression: syntax error: operator not found: "'+n.join(" ")+'"')}(t,u.inner);return function e(t,n,a){if(a||(a="ROOT"),r.isObject(n)&&!r.isArray(n)){var o=n;if(!r.has(o,"l"))throw new Error("validateExpression: "+a+".l missing in "+JSON.stringify(o));if(!r.has(o,"o"))throw new Error("validateExpression: "+a+".o missing in "+JSON.stringify(o));if(!r.has(o,"r"))throw new Error("validateExpression: "+a+".r missing in "+JSON.stringify(o));if(!r.isString(o.o))throw new Error("validateExpression: "+a+".o not a string");if(!i(t,o.o))throw new Error(a+'.o not valid: "'+o.o+'"');e(t,o.l,a+".l"),e(t,o.r,a+".r")}else if(!r.isNull(n)&&!r.isString(n)&&!r.isNumber(n))throw new Error("validateExpression: "+a+" is of invalid type")}(t,c),c}return r.isNumber(e),e},n.wrapInnerExpressions=a},{underscore:15}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("underscore"),i=e("../lib"),a=e("./validate"),o=e("./expression"),s=e("./state"),l=e("./common"),u=function(){function e(){}return e.resolveTimeline=function(e,t){if(!r.isArray(e))throw new Error("resolveTimeline: parameter timeline missing");if(!t)throw new Error("resolveTimeline: parameter options missing");a.validateTimeline(e,!1),i.resetId();var n={options:r.clone(t),objects:{},classes:{},layers:{},statistics:{unresolvedCount:0,resolvedCount:0,resolvedInstanceCount:0,resolvedObjectCount:0,resolvedGroupCount:0,resolvedKeyframeCount:0}},o=function(e,t,a,s){if(n.objects[e.id])throw Error('All timelineObjects must be unique! (duplicate: "'+e.id+'")');var u=i.extendMandadory(r.clone(e),{resolved:{resolved:!1,resolving:!1,instances:[],levelDeep:t}});a&&(u.resolved.parentId=a),s&&(u.resolved.isKeyframe=!0),l.addObjectToResolvedTimeline(n,u),e.isGroup&&e.children&&r.each(e.children,function(n){o(n,t+1,e.id)}),e.keyframes&&r.each(e.keyframes,function(n){var a=i.extendMandadory(r.clone(n),{layer:""});o(a,t+1,e.id,!0)})};return r.each(e,function(e){o(e,0)}),r.each(n.objects,function(e){c(n,e)}),n},e.resolveAllStates=function(e){return s.resolveStates(e)},e.getState=function(e,t,n){return s.getState(e,t,n)},e}();function c(e,t){if(!t.resolved.resolved){if(t.resolved.resolving)throw new Error('Circular dependency when trying to resolve "'+t.id+'"');t.resolved.resolving=!0;var n=[],a=void 0!==t.enable.repeating?o.interpretExpression(t.enable.repeating):null,s=f(e,t,a,"duration");if(r.isArray(s))throw new Error("lookupExpression should never return an array for .duration lookup");var l=void 0!==t.enable.while?t.enable.while:void 0!==t.enable.start?t.enable.start:"";"1"===t.enable.while?l="true":"0"===t.enable.while&&(l="false");var u=o.interpretExpression(l),c=null,h=!1,d=!1;t.resolved.parentId&&(h=!0,c=f(e,t,o.interpretExpression("#"+t.resolved.parentId),"start"),i.isConstant(u)&&(d=!0));var v=f(e,t,u,"start"),p=function(e){return i.operateOnArrays(c,e,function(e,t){return null===e||null===t?null:{value:e.value+t.value,references:i.joinReferences(e.references,t.references)}})};if(d&&(v=p(v)),t.enable.while)r.isArray(v)?n=v:null!==v&&(n=[{id:i.getId(),start:v.value,end:null,references:v.references}]);else{var y=[],_=0,m=0;if(r.isArray(v)?r.each(v,function(e){y.push({time:e.start,value:!0,data:{instance:e,id:t.id+"_"+_++},references:e.references})}):null!==v&&y.push({time:v.value,value:!0,data:{instance:{id:i.getId(),start:v.value,end:null,references:v.references},id:t.id+"_"+_++},references:v.references}),void 0!==t.enable.end){var b=o.interpretExpression(t.enable.end),w=b?f(e,t,b,"end"):null;d&&i.isConstant(b)&&(w=p(w)),r.isArray(w)?r.each(w,function(e){y.push({time:e.start,value:!1,data:{instance:e,id:t.id+"_"+m++},references:e.references})}):null!==w&&y.push({time:w.value,value:!1,data:{instance:{id:i.getId(),start:w.value,end:null,references:w.references},id:t.id+"_"+m++},references:w.references})}else if(void 0!==t.enable.duration){var g=o.interpretExpression(t.enable.duration),j=f(e,t,g,"duration");if(r.isArray(j)&&1===j.length&&(j={value:j[0].start,references:j[0].references}),r.isArray(j))throw new Error("lookupExpression should never return an array for .duration lookup");if(null!==j){null!==s&&j.value>s.value&&(j.value=s.value);var O=j;r.each(y,function(e){if(e.value){var t=e.time+O.value,n=i.joinReferences(e.references,O.references);y.push({time:t,value:!1,data:{id:e.data.id,instance:{id:e.data.instance.id,start:t,end:null,references:n}},references:n})}})}}n=i.convertEventsToInstances(y,!1)}if(h){var E=[];r.each(n,function(e){if(r.isArray(c)){var t=r.find(c,function(t){return-1!==e.references.indexOf(t.id)}),n=t?i.capInstances([e],[t])[0]:e;n&&(t&&(n.caps||(n.caps=[]),n.caps.push({id:t.id,start:t.start,end:t.end})),E.push(n))}}),n=E}n=i.applyRepeatingInstances(n,s,e.options),n=r.filter(n,function(e){return(e.end||1/0)>e.start}),t.resolved.resolved=!0,t.resolved.resolving=!1,t.resolved.instances=n,n.length?(e.statistics.resolvedInstanceCount+=n.length,e.statistics.resolvedCount+=1,t.isGroup&&(e.statistics.resolvedGroupCount+=1),t.resolved.isKeyframe?e.statistics.resolvedKeyframeCount+=1:e.statistics.resolvedObjectCount+=1):e.statistics.unresolvedCount+=1}}function f(e,t,n,a){if(null===n)return null;if(r.isString(n)&&i.isNumeric(n))return{value:parseFloat(n),references:[]};if(r.isNumber(n))return{value:n,references:[]};if(r.isString(n)){if(n=n.trim(),i.isConstant(n)){if(n.match(/^true$/i))return{value:0,references:[]};if(n.match(/^false$/i))return[]}var o=!1,s=!1,l=[],u=a,h="",d=n.match(/^\W*#([^.]+)(.*)/);if(d){var v=d[1];h=d[2];var p=e.objects[v];p&&l.push(p)}else{var y=n.match(/^\W*\.([^.]+)(.*)/);if(y){var _=y[1];h=y[2];var m=e.classes[_]||[];r.each(m,function(t){var n=e.objects[t];n&&l.push(n)})}else{var b=n.match(/^\W*\$([^.]+)(.*)/);if(b){var w=b[1];h=b[2];m=e.layers[w]||[];r.each(m,function(t){var n=e.objects[t];n&&l.push(n)})}}}if(l.length){if(h.match(/start/)&&(u="start"),h.match(/end/)&&(u="end"),h.match(/duration/)&&(u="duration"),"duration"===u){var g=[];r.each(l,function(t){if(c(e,t),t.resolved.resolved){var n=r.first(t.resolved.instances);if(n){var a=n&&null!==n.end?n.end-n.start:null;null!==a&&g.push({value:a,references:i.joinReferences(t.id,n.references)})}}});var j=null;return r.each(g,function(e){(null===j||e.value<j.value)&&(j=e)}),j}var O=[];if("start"===u);else{if("end"!==u)throw Error('Unknown ref: "'+u+'"');o=!o,s=!0}if(r.each(l,function(t){c(e,t),t.resolved.resolved&&(O=O.concat(t.resolved.instances))}),O.length){if(O=o?i.invertInstances(O):i.cleanInstances(O,!0,!0),s){var E=r.first(O);E&&0===E.start&&O.splice(0,1)}return O}return null}return null}if(n){var T={l:f(e,t,n.l,a),o:n.o,r:f(e,t,n.r,a)};if("!"===T.o)return T.r&&r.isArray(T.r)&&T.r.length?i.invertInstances(T.r):T.r;if(r.isNull(T.l)||r.isNull(T.r))return null;if("&"===T.o||"|"===T.o){var S=[],x=function(e,t){r.each(e,function(e){S.push({left:t,time:e.start,value:!0,references:[],data:!0,instance:e}),null!==e.end&&S.push({left:t,time:e.end,value:!1,references:[],data:!1,instance:e})})};r.isArray(T.l)&&x(T.l,!0),r.isArray(T.r)&&x(T.r,!1),S=i.sortEvents(S);var A="&"===T.o?function(e,t){return!(!e||!t)}:"|"===T.o?function(e,t){return!(!e&&!t)}:function(){return!1},R=!!i.isReference(T.l)&&!!T.l.value,M=!!i.isReference(T.r)&&!!T.r.value,P=null,L=null,k=A(R,M),D=i.joinReferences(i.isReference(T.l)?T.l.references:[],i.isReference(T.r)?T.r.references:[]),I=[],C=function(e,t,n,a){if(t)I.push({id:i.getId(),start:e,end:null,references:n,caps:a});else{var o=r.last(I);o&&(o.end=e)}};C(0,k,D,[]);for(var z=0;z<S.length;z++){var F=S[z],N=S[z+1];if(F.left?(R=F.value,P=F.instance):(M=F.value,L=F.instance),!N||N.time!==F.time){var W=A(R,M),H=i.joinReferences(P?P.references:[],L?L.references:[]),K=(P&&P.caps||[]).concat(L&&L.caps||[]);W!==k&&(C(F.time,W,H,K),k=W)}}return I}var X="+"===T.o?function(e,t){return{value:e.value+t.value,references:i.joinReferences(e.references,t.references)}}:"-"===T.o?function(e,t){return{value:e.value-t.value,references:i.joinReferences(e.references,t.references)}}:"*"===T.o?function(e,t){return{value:e.value*t.value,references:i.joinReferences(e.references,t.references)}}:"/"===T.o?function(e,t){return{value:e.value/t.value,references:i.joinReferences(e.references,t.references)}}:"%"===T.o?function(e,t){return{value:e.value%t.value,references:i.joinReferences(e.references,t.references)}}:function(){return null};return i.operateOnArrays(T.l,T.r,function(e,t){return null===e||null===t?null:X(e,t)})}return null}n.Resolver=u,n.resolveTimelineObj=c,n.lookupExpression=f},{"../lib":8,"./common":9,"./expression":10,"./state":12,"./validate":13,underscore:15}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("tslib"),i=e("underscore"),a=e("./common"),o=e("../api/enums");function s(e,t){var n={options:e.options,statistics:e.statistics,objects:{},classes:{},layers:{},state:{},nextEvents:[]},s=i.values(e.objects);s.sort(function(e,t){return(e.resolved.levelDeep||0)>(t.resolved.levelDeep||0)?1:(e.resolved.levelDeep||0)<(t.resolved.levelDeep||0)?-1:e.id>e.id?1:e.id<e.id?-1:0});var l={},c={};i.each(s,function(n){if(!n.disabled&&n.resolved.resolved&&!n.resolved.isKeyframe){var r=function e(t,n){var r=[];var a=n.resolved.parentId?t.objects[n.resolved.parentId]:null;a&&a.resolved.resolved&&(i.each(a.resolved.instances,function(e){r.push({time:e.start,enable:!0}),e.end&&r.push({time:e.end,enable:!1})}),r=r.concat(e(t,a)));return r}(e,n);n.layer&&i.each(n.resolved.instances,function(e){var a=!0;if(t&&(a=(e.start||0)<=t&&(e.end||1/0)>t),a){var o=[];o.push({time:e.start,enable:!0}),e.end&&o.push({time:e.end,enable:!1}),i.each(r,function(t){t&&t.time>(e.start||0)&&t.time<(e.end||1/0)&&o.push(t)}),i.each(o,function(t){l[t.time+""]||(l[t.time+""]=[]),l[t.time+""].push({obj:n,instance:e,enable:t.enable})})}})}}),i.each(s,function(e){!e.disabled&&e.resolved.resolved&&e.resolved.isKeyframe&&e.resolved.parentId&&i.each(e.resolved.instances,function(t){var n=[];t.start,n.push({time:t.start,enable:!0}),i.each(n,function(n){l[n.time+""]||(l[n.time+""]=[]),l[n.time+""].push({obj:e,instance:t,enable:n.enable})})})});var f={},h={},d={},v=[],p=i.map(i.keys(l),function(e){return parseFloat(e)});return p.sort(function(e,t){return e-t}),i.each(p,function(s){var p=l[s],y={};p.sort(function(e,t){if(e.obj.resolved&&t.obj.resolved){if(e.obj.resolved.isKeyframe&&!t.obj.resolved.isKeyframe)return 1;if(!e.obj.resolved.isKeyframe&&t.obj.resolved.isKeyframe)return-1;if(e.enable&&!t.enable)return 1;if(!e.enable&&t.enable)return-1;if((e.obj.resolved.levelDeep||0)>(t.obj.resolved.levelDeep||0))return 1;if((e.obj.resolved.levelDeep||0)<(t.obj.resolved.levelDeep||0))return-1}return 0}),i.each(p,function(l){var p=l.obj,_=l.instance,m=(_.start||0)<=s&&(_.end||1/0)>s,b=p.layer+"";if(!y[p.id+"_"+_.id+"_"+l.enable])if(y[p.id+"_"+_.id+"_"+l.enable]=!0,p.resolved.isKeyframe){var w=p;if(n.objects[w.id]=w,w.resolved.parentId)if((j=h[w.resolved.parentId])&&j.layer)if(f[j.layer]){var g=r.__assign({},w,{instance:_,isKeyframe:!0,keyframeEndTime:_.end});!function(e,t,n,r){e[t]||(e[t]={});e[t][n+""]||(e[t][n+""]=[]);e[t][n+""].push(r)}(n.state,j.layer+"",s,g),v.push({type:o.EventType.KEYFRAME,time:_.start,objId:w.id}),null!==_.end&&v.push({type:o.EventType.KEYFRAME,time:_.end,objId:w.id})}}else{var j;if(m&&p.resolved.parentId)m=!(!(j=p.resolved.parentId?e.objects[p.resolved.parentId]:null)||j.layer&&!h[j.id]);d[p.layer]||(d[p.layer]=[]),m?d[p.layer].push({obj:p,instance:_}):d[b]=i.reject(d[b]||[],function(e){return e.obj.id===p.id}),d[b].sort(function(e,t){return(e.obj.priority||0)<(t.obj.priority||0)?1:(e.obj.priority||0)>(t.obj.priority||0)?-1:(e.instance.start||0)<(t.instance.start||0)?1:(e.instance.start||0)>(t.instance.start||0)?-1:e.obj.id>t.obj.id?1:e.obj.id<t.obj.id?-1:0});var O=d[b][0],E=f[b],T=O&&(!E||E.id!==O.obj.id||E.instance.id!==O.instance.id),S=!O&&E;if((T||S)&&E&&(E.instance.end=s,delete h[E.id],(!t||E.instance.end>t)&&(n.nextEvents.push({type:o.EventType.END,time:E.instance.end,objId:E.id}),c[_.end+""]=o.EventType.END)),T){var x;n.objects[O.obj.id]?x=n.objects[O.obj.id]:((x=i.clone(O.obj)).content=JSON.parse(JSON.stringify(x.content)),x.resolved=r.__assign({},x.resolved||{},{instances:[]}),a.addObjectToResolvedTimeline(n,x));var A=r.__assign({},O.instance,{start:s,end:null,fromInstanceId:O.instance.id});i.each(x.resolved.instances,function(e){e.id===A.id&&(A.id=A.id+"_$"+x.resolved.instances.length)}),x.resolved.instances.push(A);var R=r.__assign({},x,{instance:A});f[b]=R,h[R.id]=R,u(n.state,b,s,R),A.start>(t||0)&&(n.nextEvents.push({type:o.EventType.START,time:A.start,objId:p.id}),c[A.start+""]=o.EventType.START)}else S&&(delete f[b],u(n.state,b,s,null))}})}),i.each(v,function(e){void 0===c[e.time+""]&&(n.nextEvents.push(e),c[e.time+""]=o.EventType.KEYFRAME)}),t&&(n.nextEvents=i.filter(n.nextEvents,function(e){return e.time>t})),n.nextEvents.sort(function(e,t){return e.time>t.time?1:e.time<t.time?-1:e.type>t.type?-1:e.type<t.type?1:e.objId<t.objId?-1:e.objId>t.objId?1:0}),n}function l(e,t){i.each(t,function(t,n){i.isArray(t)?(i.isArray(e[n])||(e[n]=[]),l(e[n],t),e[n].splice(t.length,99999)):i.isObject(t)?(i.isObject(e[n])&&!i.isArray(e[n])||(e[n]={}),l(e[n],t)):e[n]=t})}function u(e,t,n,r){e[t]||(e[t]={}),e[t][n+""]=r?[r]:r}n.getState=function(e,t,n){void 0===n&&(n=0);var a=function(e){return!!(e&&"object"==typeof e&&e.objects&&e.state&&e.nextEvents)}(e)?e:s(e,t),o={time:t,layers:{},nextEvents:i.filter(a.nextEvents,function(e){return e.time>t})};return n&&(o.nextEvents=o.nextEvents.slice(0,n)),i.each(i.keys(a.layers),function(e){var n=function(e,t,n){var a=e[t]||{},o=i.map(i.keys(a),function(e){return parseFloat(e)});o.sort(function(e,t){return e-t});var s=null,u=!1;return i.find(o,function(e){if(e<=n){var t=a[e+""];return t&&t.length?i.each(t,function(e){if(e&&e.isKeyframe){var t=e;s&&t.resolved.parentId===s.id&&(t.keyframeEndTime||1/0)>n&&(u||(u=!0,s=r.__assign({},s,{content:JSON.parse(JSON.stringify(s.content))})),l(s.content,t.content))}else s=e,u=!1}):(s=null,u=!1),!1}return!0}),s}(a.state,e,t);n&&(o.layers[e]=n)}),o},n.resolveStates=s,n.applyKeyframeContent=l},{"../api/enums":6,"./common":9,tslib:14,underscore:15}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("underscore");function i(e,t,n){if(n||(n={}),!e)throw new Error("Object is undefined");if(!r.isObject(e))throw new Error("Object is not an object");if(!e.id)throw new Error('Object missing "id" attribute');if(!r.isString(e.id))throw new Error('Object "id" attribute is not a string: "'+e.id+'"');if(n[e.id])throw new Error('Object id "'+e.id+'" is not unique');if(n[e.id]=!0,void 0===e.layer)throw new Error('Object "'+e.id+'": "layer" attribute is undefined');if(!e.content)throw new Error('Object "'+e.id+'": "content" attribute must be set');if(!e.enable)throw new Error('Object "'+e.id+'": "enable" attribute must be set');if(void 0!==e.enable.start){if(t&&void 0!==e.enable.while)throw new Error('Object "'+e.id+'": "enable.start" and "enable.while" cannot be combined');if(t&&void 0!==e.enable.end&&void 0!==e.enable.duration)throw new Error('Object "'+e.id+'": "enable.end" and "enable.duration" cannot be combined')}else{if(void 0===e.enable.while)throw new Error('Object "'+e.id+'": "enable.start" or "enable.while" must be set');if(t&&void 0!==e.enable.end)throw new Error('Object "'+e.id+'": "enable.while" and "enable.end" cannot be combined');if(t&&void 0!==e.enable.duration)throw new Error('Object "'+e.id+'": "enable.while" and "enable.duration" cannot be combined')}if(e.keyframes&&r.each(e.keyframes,function(r,i){try{a(r,t,n)}catch(t){throw new Error('Object "'+e.id+'" keyframe['+i+"]: "+t)}}),e.classes&&r.each(e.classes,function(t,n){if(t&&!r.isString(t))throw new Error('Object "'+e.id+'": "classes['+n+']" is not a string')}),e.children&&!e.isGroup)throw new Error('Object "'+e.id+'": attribute "children" is set but "isGroup" is not');if(e.isGroup&&!e.children)throw new Error('Object "'+e.id+'": attribute "isGroup" is set but "children" missing');if(e.children&&r.each(e.children,function(r,a){try{i(r,t,n)}catch(t){throw new Error('Object "'+e.id+'" child['+a+"]: "+t)}}),void 0!==e.priority&&!r.isNumber(e.priority))throw new Error('Object "'+e.id+'": attribute "priority" is not a number')}function a(e,t,n){if(n||(n={}),!e)throw new Error("Keyframe is undefined");if(!r.isObject(e))throw new Error("Keyframe is not an object");if(!e.id)throw new Error("Keyframe missing id attribute");if(!r.isString(e.id))throw new Error('Keyframe id attribute is not a string: "'+e.id+'"');if(n[e.id])throw new Error('Keyframe id "'+e.id+'" is not unique');if(n[e.id]=!0,!e.content)throw new Error('Keyframe "'+e.id+'": "content" attribute must be set');if(!e.enable)throw new Error('Keyframe "'+e.id+'": "enable" attribute must be set');if(void 0!==e.enable.start){if(t&&void 0!==e.enable.while)throw new Error('Keyframe "'+e.id+'": "enable.start" and "enable.while" cannot be combined');if(t&&void 0!==e.enable.end&&void 0!==e.enable.duration)throw new Error('Keyframe "'+e.id+'": "enable.end" and "enable.duration" cannot be combined')}else{if(void 0===e.enable.while)throw new Error('Keyframe "'+e.id+'": "enable.start" or "enable.while" must be set');if(t&&void 0!==e.enable.end)throw new Error('Keyframe "'+e.id+'": "enable.while" and "enable.end" cannot be combined');if(t&&void 0!==e.enable.duration)throw new Error('Keyframe "'+e.id+'": "enable.while" and "enable.duration" cannot be combined')}e.classes&&r.each(e.classes,function(t,n){if(t&&!r.isString(t))throw new Error('Keyframe "'+e.id+'": "classes['+n+']" is not a string')})}n.validateTimeline=function(e,t){var n={};r.each(e,function(e){i(e,t,n)})},n.validateObject=function(e,t){i(e,t)},n.validateKeyframe=function(e,t){a(e,t)}},{underscore:15}],14:[function(e,t,n){(function(e){var n,r,i,a,o,s,l,u,c,f,h,d,v,p,y,_,m,b,w;!function(n){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function i(e,t){return e!==r&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}"object"==typeof t&&"object"==typeof t.exports?n(i(r,i(t.exports))):n(i(r))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};n=function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n},a=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},o=function(e,t){return function(n,r){t(n,r,e)}},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}l((r=r.apply(e,t||[])).next())})},u=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},c=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},f=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},h=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},d=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e},v=function(e){return this instanceof v?(this.v=e,this):new v(e)},p=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof v?Promise.resolve(n.value.v).then(l,u):c(a[0][2],n)}catch(e){c(a[0][3],e)}var n}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},y=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:v(e[r](t)),done:"return"===r}:i?i(t):t}:i}},_=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}},m=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},w=function(e){return e&&e.__esModule?e:{default:e}},e("__extends",n),e("__assign",r),e("__rest",i),e("__decorate",a),e("__param",o),e("__metadata",s),e("__awaiter",l),e("__generator",u),e("__exportStar",c),e("__values",f),e("__read",h),e("__spread",d),e("__await",v),e("__asyncGenerator",p),e("__asyncDelegator",y),e("__asyncValues",_),e("__makeTemplateObject",m),e("__importStar",b),e("__importDefault",w)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t,n){(function(e){!function(){var r="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||this||{},i=r._,a=Array.prototype,o=Object.prototype,s="undefined"!=typeof Symbol?Symbol.prototype:null,l=a.push,u=a.slice,c=o.toString,f=o.hasOwnProperty,h=Array.isArray,d=Object.keys,v=Object.create,p=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};void 0===n||n.nodeType?r._=y:(void 0!==t&&!t.nodeType&&t.exports&&(n=t.exports=y),n._=y),y.VERSION="1.9.1";var _,m=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,a){return e.call(t,n,r,i,a)}}return function(){return e.apply(t,arguments)}},b=function(e,t,n){return y.iteratee!==_?y.iteratee(e,t):null==e?y.identity:y.isFunction(e)?m(e,t,n):y.isObject(e)&&!y.isArray(e)?y.matcher(e):y.property(e)};y.iteratee=_=function(e,t){return b(e,t,1/0)};var w=function(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var a=Array(t+1);for(i=0;i<t;i++)a[i]=arguments[i];return a[t]=r,e.apply(this,a)}},g=function(e){if(!y.isObject(e))return{};if(v)return v(e);p.prototype=e;var t=new p;return p.prototype=null,t},j=function(e){return function(t){return null==t?void 0:t[e]}},O=function(e,t){return null!=e&&f.call(e,t)},E=function(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0},T=Math.pow(2,53)-1,S=j("length"),x=function(e){var t=S(e);return"number"==typeof t&&t>=0&&t<=T};y.each=y.forEach=function(e,t,n){var r,i;if(t=m(t,n),x(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var a=y.keys(e);for(r=0,i=a.length;r<i;r++)t(e[a[r]],a[r],e)}return e},y.map=y.collect=function(e,t,n){t=b(t,n);for(var r=!x(e)&&y.keys(e),i=(r||e).length,a=Array(i),o=0;o<i;o++){var s=r?r[o]:o;a[o]=t(e[s],s,e)}return a};var A=function(e){return function(t,n,r,i){var a=arguments.length>=3;return function(t,n,r,i){var a=!x(t)&&y.keys(t),o=(a||t).length,s=e>0?0:o-1;for(i||(r=t[a?a[s]:s],s+=e);s>=0&&s<o;s+=e){var l=a?a[s]:s;r=n(r,t[l],l,t)}return r}(t,m(n,i,4),r,a)}};y.reduce=y.foldl=y.inject=A(1),y.reduceRight=y.foldr=A(-1),y.find=y.detect=function(e,t,n){var r=(x(e)?y.findIndex:y.findKey)(e,t,n);if(void 0!==r&&-1!==r)return e[r]},y.filter=y.select=function(e,t,n){var r=[];return t=b(t,n),y.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},y.reject=function(e,t,n){return y.filter(e,y.negate(b(t)),n)},y.every=y.all=function(e,t,n){t=b(t,n);for(var r=!x(e)&&y.keys(e),i=(r||e).length,a=0;a<i;a++){var o=r?r[a]:a;if(!t(e[o],o,e))return!1}return!0},y.some=y.any=function(e,t,n){t=b(t,n);for(var r=!x(e)&&y.keys(e),i=(r||e).length,a=0;a<i;a++){var o=r?r[a]:a;if(t(e[o],o,e))return!0}return!1},y.contains=y.includes=y.include=function(e,t,n,r){return x(e)||(e=y.values(e)),("number"!=typeof n||r)&&(n=0),y.indexOf(e,t,n)>=0},y.invoke=w(function(e,t,n){var r,i;return y.isFunction(t)?i=t:y.isArray(t)&&(r=t.slice(0,-1),t=t[t.length-1]),y.map(e,function(e){var a=i;if(!a){if(r&&r.length&&(e=E(e,r)),null==e)return;a=e[t]}return null==a?a:a.apply(e,n)})}),y.pluck=function(e,t){return y.map(e,y.property(t))},y.where=function(e,t){return y.filter(e,y.matcher(t))},y.findWhere=function(e,t){return y.find(e,y.matcher(t))},y.max=function(e,t,n){var r,i,a=-1/0,o=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,l=(e=x(e)?e:y.values(e)).length;s<l;s++)null!=(r=e[s])&&r>a&&(a=r);else t=b(t,n),y.each(e,function(e,n,r){((i=t(e,n,r))>o||i===-1/0&&a===-1/0)&&(a=e,o=i)});return a},y.min=function(e,t,n){var r,i,a=1/0,o=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,l=(e=x(e)?e:y.values(e)).length;s<l;s++)null!=(r=e[s])&&r<a&&(a=r);else t=b(t,n),y.each(e,function(e,n,r){((i=t(e,n,r))<o||i===1/0&&a===1/0)&&(a=e,o=i)});return a},y.shuffle=function(e){return y.sample(e,1/0)},y.sample=function(e,t,n){if(null==t||n)return x(e)||(e=y.values(e)),e[y.random(e.length-1)];var r=x(e)?y.clone(e):y.values(e),i=S(r);t=Math.max(Math.min(t,i),0);for(var a=i-1,o=0;o<t;o++){var s=y.random(o,a),l=r[o];r[o]=r[s],r[s]=l}return r.slice(0,t)},y.sortBy=function(e,t,n){var r=0;return t=b(t,n),y.pluck(y.map(e,function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var R=function(e,t){return function(n,r,i){var a=t?[[],[]]:{};return r=b(r,i),y.each(n,function(t,i){var o=r(t,i,n);e(a,t,o)}),a}};y.groupBy=R(function(e,t,n){O(e,n)?e[n].push(t):e[n]=[t]}),y.indexBy=R(function(e,t,n){e[n]=t}),y.countBy=R(function(e,t,n){O(e,n)?e[n]++:e[n]=1});var M=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(e){return e?y.isArray(e)?u.call(e):y.isString(e)?e.match(M):x(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:x(e)?e.length:y.keys(e).length},y.partition=R(function(e,t,n){e[n?0:1].push(t)},!0),y.first=y.head=y.take=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[0]:y.initial(e,e.length-t)},y.initial=function(e,t,n){return u.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},y.last=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[e.length-1]:y.rest(e,Math.max(0,e.length-t))},y.rest=y.tail=y.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},y.compact=function(e){return y.filter(e,Boolean)};var P=function(e,t,n,r){for(var i=(r=r||[]).length,a=0,o=S(e);a<o;a++){var s=e[a];if(x(s)&&(y.isArray(s)||y.isArguments(s)))if(t)for(var l=0,u=s.length;l<u;)r[i++]=s[l++];else P(s,t,n,r),i=r.length;else n||(r[i++]=s)}return r};y.flatten=function(e,t){return P(e,t,!1)},y.without=w(function(e,t){return y.difference(e,t)}),y.uniq=y.unique=function(e,t,n,r){y.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=b(n,r));for(var i=[],a=[],o=0,s=S(e);o<s;o++){var l=e[o],u=n?n(l,o,e):l;t&&!n?(o&&a===u||i.push(l),a=u):n?y.contains(a,u)||(a.push(u),i.push(l)):y.contains(i,l)||i.push(l)}return i},y.union=w(function(e){return y.uniq(P(e,!0,!0))}),y.intersection=function(e){for(var t=[],n=arguments.length,r=0,i=S(e);r<i;r++){var a=e[r];if(!y.contains(t,a)){var o;for(o=1;o<n&&y.contains(arguments[o],a);o++);o===n&&t.push(a)}}return t},y.difference=w(function(e,t){return t=P(t,!0,!0),y.filter(e,function(e){return!y.contains(t,e)})}),y.unzip=function(e){for(var t=e&&y.max(e,S).length||0,n=Array(t),r=0;r<t;r++)n[r]=y.pluck(e,r);return n},y.zip=w(y.unzip),y.object=function(e,t){for(var n={},r=0,i=S(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n};var L=function(e){return function(t,n,r){n=b(n,r);for(var i=S(t),a=e>0?0:i-1;a>=0&&a<i;a+=e)if(n(t[a],a,t))return a;return-1}};y.findIndex=L(1),y.findLastIndex=L(-1),y.sortedIndex=function(e,t,n,r){for(var i=(n=b(n,r,1))(t),a=0,o=S(e);a<o;){var s=Math.floor((a+o)/2);n(e[s])<i?a=s+1:o=s}return a};var k=function(e,t,n){return function(r,i,a){var o=0,s=S(r);if("number"==typeof a)e>0?o=a>=0?a:Math.max(a+s,o):s=a>=0?Math.min(a+1,s):a+s+1;else if(n&&a&&s)return r[a=n(r,i)]===i?a:-1;if(i!=i)return(a=t(u.call(r,o,s),y.isNaN))>=0?a+o:-1;for(a=e>0?o:s-1;a>=0&&a<s;a+=e)if(r[a]===i)return a;return-1}};y.indexOf=k(1,y.findIndex,y.sortedIndex),y.lastIndexOf=k(-1,y.findLastIndex),y.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),a=0;a<r;a++,e+=n)i[a]=e;return i},y.chunk=function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(u.call(e,r,r+=t));return n};var D=function(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var a=g(e.prototype),o=e.apply(a,i);return y.isObject(o)?o:a};y.bind=w(function(e,t,n){if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var r=w(function(i){return D(e,r,t,this,n.concat(i))});return r}),y.partial=w(function(e,t){var n=y.partial.placeholder,r=function(){for(var i=0,a=t.length,o=Array(a),s=0;s<a;s++)o[s]=t[s]===n?arguments[i++]:t[s];for(;i<arguments.length;)o.push(arguments[i++]);return D(e,r,this,this,o)};return r}),y.partial.placeholder=y,y.bindAll=w(function(e,t){var n=(t=P(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=y.bind(e[r],e)}}),y.memoize=function(e,t){var n=function(r){var i=n.cache,a=""+(t?t.apply(this,arguments):r);return O(i,a)||(i[a]=e.apply(this,arguments)),i[a]};return n.cache={},n},y.delay=w(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(e,t,n){var r,i,a,o,s=0;n||(n={});var l=function(){s=!1===n.leading?0:y.now(),r=null,o=e.apply(i,a),r||(i=a=null)},u=function(){var u=y.now();s||!1!==n.leading||(s=u);var c=t-(u-s);return i=this,a=arguments,c<=0||c>t?(r&&(clearTimeout(r),r=null),s=u,o=e.apply(i,a),r||(i=a=null)):r||!1===n.trailing||(r=setTimeout(l,c)),o};return u.cancel=function(){clearTimeout(r),s=0,r=i=a=null},u},y.debounce=function(e,t,n){var r,i,a=function(t,n){r=null,n&&(i=e.apply(t,n))},o=w(function(o){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(a,t),s&&(i=e.apply(this,o))}else r=y.delay(a,t,this,o);return i});return o.cancel=function(){clearTimeout(r),r=null},o},y.wrap=function(e,t){return y.partial(t,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},y.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},y.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},y.once=y.partial(y.before,2),y.restArguments=w;var I=!{toString:null}.propertyIsEnumerable("toString"),C=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],z=function(e,t){var n=C.length,r=e.constructor,i=y.isFunction(r)&&r.prototype||o,a="constructor";for(O(e,a)&&!y.contains(t,a)&&t.push(a);n--;)(a=C[n])in e&&e[a]!==i[a]&&!y.contains(t,a)&&t.push(a)};y.keys=function(e){if(!y.isObject(e))return[];if(d)return d(e);var t=[];for(var n in e)O(e,n)&&t.push(n);return I&&z(e,t),t},y.allKeys=function(e){if(!y.isObject(e))return[];var t=[];for(var n in e)t.push(n);return I&&z(e,t),t},y.values=function(e){for(var t=y.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},y.mapObject=function(e,t,n){t=b(t,n);for(var r=y.keys(e),i=r.length,a={},o=0;o<i;o++){var s=r[o];a[s]=t(e[s],s,e)}return a},y.pairs=function(e){for(var t=y.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},y.invert=function(e){for(var t={},n=y.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},y.functions=y.methods=function(e){var t=[];for(var n in e)y.isFunction(e[n])&&t.push(n);return t.sort()};var F=function(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var a=arguments[i],o=e(a),s=o.length,l=0;l<s;l++){var u=o[l];t&&void 0!==n[u]||(n[u]=a[u])}return n}};y.extend=F(y.allKeys),y.extendOwn=y.assign=F(y.keys),y.findKey=function(e,t,n){t=b(t,n);for(var r,i=y.keys(e),a=0,o=i.length;a<o;a++)if(t(e[r=i[a]],r,e))return r};var N,W,H=function(e,t,n){return t in n};y.pick=w(function(e,t){var n={},r=t[0];if(null==e)return n;y.isFunction(r)?(t.length>1&&(r=m(r,t[1])),t=y.allKeys(e)):(r=H,t=P(t,!1,!1),e=Object(e));for(var i=0,a=t.length;i<a;i++){var o=t[i],s=e[o];r(s,o,e)&&(n[o]=s)}return n}),y.omit=w(function(e,t){var n,r=t[0];return y.isFunction(r)?(r=y.negate(r),t.length>1&&(n=t[1])):(t=y.map(P(t,!1,!1),String),r=function(e,n){return!y.contains(t,n)}),y.pick(e,r,n)}),y.defaults=F(y.allKeys,!0),y.create=function(e,t){var n=g(e);return t&&y.extendOwn(n,t),n},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,t){return t(e),e},y.isMatch=function(e,t){var n=y.keys(t),r=n.length;if(null==e)return!r;for(var i=Object(e),a=0;a<r;a++){var o=n[a];if(t[o]!==i[o]||!(o in i))return!1}return!0},N=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&W(e,t,n,r)},W=function(e,t,n,r){e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var i=c.call(e);if(i!==c.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return s.valueOf.call(e)===s.valueOf.call(t)}var a="[object Array]"===i;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,l=t.constructor;if(o!==l&&!(y.isFunction(o)&&o instanceof o&&y.isFunction(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),a){if((u=e.length)!==t.length)return!1;for(;u--;)if(!N(e[u],t[u],n,r))return!1}else{var f,h=y.keys(e);if(u=h.length,y.keys(t).length!==u)return!1;for(;u--;)if(f=h[u],!O(t,f)||!N(e[f],t[f],n,r))return!1}return n.pop(),r.pop(),!0},y.isEqual=function(e,t){return N(e,t)},y.isEmpty=function(e){return null==e||(x(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length)},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=h||function(e){return"[object Array]"===c.call(e)},y.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){y["is"+e]=function(t){return c.call(t)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return O(e,"callee")});var K=r.document&&r.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof K&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return!y.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&isNaN(e)},y.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===c.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,t){if(!y.isArray(t))return O(e,t);for(var n=t.length,r=0;r<n;r++){var i=t[r];if(null==e||!f.call(e,i))return!1;e=e[i]}return!!n},y.noConflict=function(){return r._=i,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=function(e){return y.isArray(e)?function(t){return E(t,e)}:j(e)},y.propertyOf=function(e){return null==e?function(){}:function(t){return y.isArray(t)?E(e,t):e[t]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(t){return y.isMatch(t,e)}},y.times=function(e,t,n){var r=Array(Math.max(0,e));t=m(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},y.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},U=y.invert(X),B=function(e){var t=function(t){return e[t]},n="(?:"+y.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}};y.escape=B(X),y.unescape=B(U),y.result=function(e,t,n){y.isArray(t)||(t=[t]);var r=t.length;if(!r)return y.isFunction(n)?n.call(e):n;for(var i=0;i<r;i++){var a=null==e?void 0:e[t[i]];void 0===a&&(a=n,i=r),e=y.isFunction(a)?a.call(e):a}return e};var $=0;y.uniqueId=function(e){var t=++$+"";return e?e+t:t},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(e){return"\\"+q[e]};y.template=function(e,t,n){!t&&n&&(t=n),t=y.defaults({},t,y.templateSettings);var r,i=RegExp([(t.escape||V).source,(t.interpolate||V).source,(t.evaluate||V).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(i,function(t,n,r,i,s){return o+=e.slice(a,s).replace(G,Z),a=s+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(o+="';\n"+i+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var s=function(e){return r.call(this,e,y)},l=t.variable||"obj";return s.source="function("+l+"){\n"+o+"}",s},y.chain=function(e){var t=y(e);return t._chain=!0,t};var Y=function(e,t){return e._chain?y(t).chain():t};y.mixin=function(e){return y.each(y.functions(e),function(t){var n=y[t]=e[t];y.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),Y(this,n.apply(y,e))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];y.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],Y(this,n)}}),y.each(["concat","join","slice"],function(e){var t=a[e];y.prototype[e]=function(){return Y(this,t.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});
//# sourceMappingURL=timeline-visualizer.min.js.map
